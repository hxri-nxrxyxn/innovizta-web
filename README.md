code heavily borrowed from upscayl[https://github.com/upscayl]
