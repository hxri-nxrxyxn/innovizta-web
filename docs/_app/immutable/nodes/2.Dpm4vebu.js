import{s as Fe,e as L,a as j,t as Ro,c as F,b as Et,f as Z,g as z,d as Po,m as k,i as ie,h as V,j as pl,l as ht,n as Ye,R as ml,a1 as ai,P as Tn,p as gl,a2 as Ls,a3 as _l,a4 as Co,N as yl,D as Fs,a5 as $s}from"../chunks/scheduler.CM2Z-_BB.js";import{S as $e,i as Ue,b as ft,d as dt,m as pt,a as mt,t as gt,e as _t,f as In,h as Us}from"../chunks/index.DSp5iZRi.js";import{I as Qe}from"../chunks/Icon.L12kMHHK.js";const vl=!0,Jf=Object.freeze(Object.defineProperty({__proto__:null,prerender:vl},Symbol.toStringTag,{value:"Module"}));function El(n){let t,e,i,s,o,l,c;return i=new Qe({props:{icon:n[0],width:n[1]}}),{c(){t=L("div"),e=L("div"),ft(i.$$.fragment),s=j(),o=L("p"),l=Ro(n[2]),this.h()},l(f){t=F(f,"DIV",{class:!0});var p=Et(t);e=F(p,"DIV",{class:!0});var E=Et(e);dt(i.$$.fragment,E),E.forEach(Z),s=z(p),o=F(p,"P",{});var R=Et(o);l=Po(R,n[2]),R.forEach(Z),p.forEach(Z),this.h()},h(){k(e,"class","flex items-center justify-center rounded-lg bg-slate-800 p-2 ring-1 ring-slate-500"),k(t,"class","flex flex-row items-center gap-5 font-light text-slate-100")},m(f,p){ie(f,t,p),V(t,e),pt(i,e,null),V(t,s),V(t,o),V(o,l),c=!0},p(f,[p]){const E={};p&1&&(E.icon=f[0]),p&2&&(E.width=f[1]),i.$set(E),(!c||p&4)&&pl(l,f[2])},i(f){c||(mt(i.$$.fragment,f),c=!0)},o(f){gt(i.$$.fragment,f),c=!1},d(f){f&&Z(t),_t(i)}}}function Tl(n,t,e){let{icon:i="ph:arrow-right"}=t,{width:s="20px"}=t,{text:o=""}=t;return n.$$set=l=>{"icon"in l&&e(0,i=l.icon),"width"in l&&e(1,s=l.width),"text"in l&&e(2,o=l.text)},[i,s,o]}class le extends $e{constructor(t){super(),Ue(this,t,Tl,El,Fe,{icon:0,width:1,text:2})}}function Il(n){let t,e,i,s='From Concept to Creation. <br/><span class="text-slate-50">Engineering Your Vision.</span>',o,l,c="Innovizta Technologies is your dedicated partner in turning ambitious ideas into reality. We empower the next generation with affordable GPU cloud access for ML, build bespoke applications for clients, and engineer cutting-edge robotic solutions from the ground up.",f,p,E,R,w,S,D,N,x,B,O,q='<img src="/innovizta-desktop.png" alt="A showcase of Innovizta&#39;s custom technology solutions in action" class="lg:ml-16"/>',X;return E=new le({props:{icon:"ph:wifi-slash",text:"Affordable Cloud GPU for ML"}}),w=new le({props:{icon:"ph:list-checks",text:"End-to-End Project Development"}}),D=new le({props:{icon:"ph:paint-brush",text:"Custom Software & App Solutions"}}),x=new le({props:{icon:"ph:leaf",text:"Robotics & Automation"}}),{c(){t=L("div"),e=L("div"),i=L("h3"),i.innerHTML=s,o=j(),l=L("p"),l.textContent=c,f=j(),p=L("div"),ft(E.$$.fragment),R=j(),ft(w.$$.fragment),S=j(),ft(D.$$.fragment),N=j(),ft(x.$$.fragment),B=j(),O=L("div"),O.innerHTML=q,this.h()},l(U){t=F(U,"DIV",{class:!0,id:!0});var G=Et(t);e=F(G,"DIV",{class:!0});var y=Et(e);i=F(y,"H3",{class:!0,"data-svelte-h":!0}),ht(i)!=="svelte-1p8j1bs"&&(i.innerHTML=s),o=z(y),l=F(y,"P",{class:!0,"data-svelte-h":!0}),ht(l)!=="svelte-lgapqc"&&(l.textContent=c),f=z(y),p=F(y,"DIV",{class:!0});var d=Et(p);dt(E.$$.fragment,d),R=z(d),dt(w.$$.fragment,d),S=z(d),dt(D.$$.fragment,d),N=z(d),dt(x.$$.fragment,d),d.forEach(Z),y.forEach(Z),B=z(G),O=F(G,"DIV",{class:!0,"data-svelte-h":!0}),ht(O)!=="svelte-hw7cbw"&&(O.innerHTML=q),G.forEach(Z),this.h()},h(){k(i,"class","text-4xl font-semibold leading-snug text-slate-300"),k(l,"class","max-w-lg text-xl font-light text-slate-300"),k(p,"class","flex flex-col gap-4"),k(e,"class","flex flex-col gap-8 pb-20 md:py-20"),k(O,"class","-right-1/4 left-1/2 lg:absolute"),k(t,"class","relative mt-40 flex min-h-screen w-full flex-col-reverse overflow-hidden px-4 md:px-24 lg:flex-row"),k(t,"id","desktop")},m(U,G){ie(U,t,G),V(t,e),V(e,i),V(e,o),V(e,l),V(e,f),V(e,p),pt(E,p,null),V(p,R),pt(w,p,null),V(p,S),pt(D,p,null),V(p,N),pt(x,p,null),V(t,B),V(t,O),X=!0},p:Ye,i(U){X||(mt(E.$$.fragment,U),mt(w.$$.fragment,U),mt(D.$$.fragment,U),mt(x.$$.fragment,U),X=!0)},o(U){gt(E.$$.fragment,U),gt(w.$$.fragment,U),gt(D.$$.fragment,U),gt(x.$$.fragment,U),X=!1},d(U){U&&Z(t),_t(E),_t(w),_t(D),_t(x)}}}class wl extends $e{constructor(t){super(),Ue(this,t,null,Il,Fe,{})}}function Al(n){let t,e,i='<h1 class="text-4xl font-semibold text-slate-200">Our Core Services</h1> <p class="text-lg font-light text-slate-400">Tailored solutions for every technological challenge.</p>',s,o,l,c,f,p,E="Project Development",R,w,S="From initial concept and planning to final deployment and support.",D,N,x,B,O,q="Personalized Solutions",X,U,G="Bespoke applications and software built to solve your unique problems.",y,d,g,_,v,T="Robotics Projects",m,tt,vt="Engineering intelligent systems that interact with the physical world.",It,rt,at,ee,Ht,qt="Project Assistance",xt,et,Qt="Expert guidance and hands-on help to push your student or client projects forward.",Wt;return c=new Qe({props:{icon:"ph:rocket-launch-fill",width:"5rem"}}),x=new Qe({props:{icon:"ph:puzzle-piece-fill",width:"5rem"}}),g=new Qe({props:{icon:"ph:robot-fill",width:"5rem"}}),at=new Qe({props:{icon:"ph:lifebuoy-fill",width:"5rem"}}),{c(){t=L("div"),e=L("div"),e.innerHTML=i,s=j(),o=L("div"),l=L("a"),ft(c.$$.fragment),f=j(),p=L("h5"),p.textContent=E,R=j(),w=L("p"),w.textContent=S,D=j(),N=L("a"),ft(x.$$.fragment),B=j(),O=L("h5"),O.textContent=q,X=j(),U=L("p"),U.textContent=G,y=j(),d=L("a"),ft(g.$$.fragment),_=j(),v=L("h5"),v.textContent=T,m=j(),tt=L("p"),tt.textContent=vt,It=j(),rt=L("a"),ft(at.$$.fragment),ee=j(),Ht=L("h5"),Ht.textContent=qt,xt=j(),et=L("p"),et.textContent=Qt,this.h()},l(ut){t=F(ut,"DIV",{class:!0,id:!0});var Ut=Et(t);e=F(Ut,"DIV",{class:!0,"data-svelte-h":!0}),ht(e)!=="svelte-1pnycme"&&(e.innerHTML=i),s=z(Ut),o=F(Ut,"DIV",{class:!0});var Xt=Et(o);l=F(Xt,"A",{href:!0,class:!0});var ae=Et(l);dt(c.$$.fragment,ae),f=z(ae),p=F(ae,"H5",{class:!0,"data-svelte-h":!0}),ht(p)!=="svelte-19a0tmw"&&(p.textContent=E),R=z(ae),w=F(ae,"P",{class:!0,"data-svelte-h":!0}),ht(w)!=="svelte-12deduj"&&(w.textContent=S),ae.forEach(Z),D=z(Xt),N=F(Xt,"A",{href:!0,class:!0});var Gt=Et(N);dt(x.$$.fragment,Gt),B=z(Gt),O=F(Gt,"H5",{class:!0,"data-svelte-h":!0}),ht(O)!=="svelte-7l4rnw"&&(O.textContent=q),X=z(Gt),U=F(Gt,"P",{class:!0,"data-svelte-h":!0}),ht(U)!=="svelte-1yuiv4n"&&(U.textContent=G),Gt.forEach(Z),y=z(Xt),d=F(Xt,"A",{href:!0,class:!0});var Yt=Et(d);dt(g.$$.fragment,Yt),_=z(Yt),v=F(Yt,"H5",{class:!0,"data-svelte-h":!0}),ht(v)!=="svelte-s4ppej"&&(v.textContent=T),m=z(Yt),tt=F(Yt,"P",{class:!0,"data-svelte-h":!0}),ht(tt)!=="svelte-kaclb4"&&(tt.textContent=vt),Yt.forEach(Z),It=z(Xt),rt=F(Xt,"A",{href:!0,class:!0});var Jt=Et(rt);dt(at.$$.fragment,Jt),ee=z(Jt),Ht=F(Jt,"H5",{class:!0,"data-svelte-h":!0}),ht(Ht)!=="svelte-4gyxbp"&&(Ht.textContent=qt),xt=z(Jt),et=F(Jt,"P",{class:!0,"data-svelte-h":!0}),ht(et)!=="svelte-dmr6mv"&&(et.textContent=Qt),Jt.forEach(Z),Xt.forEach(Z),Ut.forEach(Z),this.h()},h(){k(e,"class","flex w-full flex-col items-center gap-2 text-center"),k(p,"class","text-xl font-medium"),k(w,"class","text-sm text-slate-400"),k(l,"href","mailto:support@innoviztatechnologies.com"),k(l,"class","flex h-56 w-56 flex-col items-center justify-center gap-5 rounded-2xl bg-slate-800 p-4 text-center ring-1 ring-slate-500 transition-all duration-500 hover:scale-110 hover:bg-slate-700 md:h-64 md:w-64"),k(O,"class","text-xl font-medium"),k(U,"class","text-sm text-slate-400"),k(N,"href","mailto:support@innoviztatechnologies.com"),k(N,"class","flex h-56 w-56 flex-col items-center justify-center gap-5 rounded-2xl bg-slate-800 p-4 text-center ring-1 ring-slate-500 transition-all duration-500 hover:scale-110 hover:bg-slate-700 md:h-64 md:w-64"),k(v,"class","text-xl font-medium"),k(tt,"class","text-sm text-slate-400"),k(d,"href","mailto:support@innoviztatechnologies.com"),k(d,"class","flex h-56 w-56 flex-col items-center justify-center gap-5 rounded-2xl bg-slate-800 p-4 text-center ring-1 ring-slate-500 transition-all duration-500 hover:scale-110 hover:bg-slate-700 md:h-64 md:w-64"),k(Ht,"class","text-xl font-medium"),k(et,"class","text-sm text-slate-400"),k(rt,"href","mailto:support@innoviztatechnologies.com"),k(rt,"class","flex h-56 w-56 flex-col items-center justify-center gap-5 rounded-2xl bg-slate-800 p-4 text-center ring-1 ring-slate-500 transition-all duration-500 hover:scale-110 hover:bg-slate-700 md:h-64 md:w-64"),k(o,"class","grid grid-cols-1 place-items-center gap-5 md:grid-cols-2 lg:grid-cols-4"),k(t,"class","flex flex-col gap-20 px-4 text-slate-300 md:px-24"),k(t,"id","services")},m(ut,Ut){ie(ut,t,Ut),V(t,e),V(t,s),V(t,o),V(o,l),pt(c,l,null),V(l,f),V(l,p),V(l,R),V(l,w),V(o,D),V(o,N),pt(x,N,null),V(N,B),V(N,O),V(N,X),V(N,U),V(o,y),V(o,d),pt(g,d,null),V(d,_),V(d,v),V(d,m),V(d,tt),V(o,It),V(o,rt),pt(at,rt,null),V(rt,ee),V(rt,Ht),V(rt,xt),V(rt,et),Wt=!0},p:Ye,i(ut){Wt||(mt(c.$$.fragment,ut),mt(x.$$.fragment,ut),mt(g.$$.fragment,ut),mt(at.$$.fragment,ut),Wt=!0)},o(ut){gt(c.$$.fragment,ut),gt(x.$$.fragment,ut),gt(g.$$.fragment,ut),gt(at.$$.fragment,ut),Wt=!1},d(ut){ut&&Z(t),_t(c),_t(x),_t(g),_t(at)}}}class Rl extends $e{constructor(t){super(),Ue(this,t,null,Al,Fe,{})}}function wn(n,{delay:t=0,duration:e=400,easing:i=ml}={}){const s=+getComputedStyle(n).opacity;return{delay:t,duration:e,easing:i,css:o=>`opacity: ${o*s}`}}const Pl=""+new URL("../assets/ring.BDdD47ci.png",import.meta.url).href;function Cl(n){let t,e,i,s,o,l,c,f,p,E,R=`Turning <span class="font-medium text-slate-200">Ideas</span> into
			<span class="font-medium text-slate-200">Impact</span>`,w,S,D,N='Where innovation meets execution through powerful <span class="underline">compute</span>.',x,B,O,q="",X,U,G,y,d,g,_="",v,T;return c=new Qe({props:{icon:"ph:arrow-right",width:"16px"}}),{c(){t=L("section"),e=L("div"),i=L("a"),s=L("img"),l=Ro(`
			Explore Innovizta Cloud `),ft(c.$$.fragment),p=j(),E=L("h1"),E.innerHTML=R,S=j(),D=L("h4"),D.innerHTML=N,B=j(),O=L("div"),O.innerHTML=q,U=j(),G=L("img"),d=j(),g=L("div"),g.innerHTML=_,this.h()},l(m){t=F(m,"SECTION",{class:!0});var tt=Et(t);e=F(tt,"DIV",{class:!0});var vt=Et(e);i=F(vt,"A",{href:!0,class:!0});var It=Et(i);s=F(It,"IMG",{src:!0}),l=Po(It,`
			Explore Innovizta Cloud `),dt(c.$$.fragment,It),It.forEach(Z),p=z(vt),E=F(vt,"H1",{class:!0,"data-svelte-h":!0}),ht(E)!=="svelte-15zv7oe"&&(E.innerHTML=R),S=z(vt),D=F(vt,"H4",{class:!0,"data-svelte-h":!0}),ht(D)!=="svelte-3hz8zz"&&(D.innerHTML=N),B=z(vt),O=F(vt,"DIV",{class:!0,"data-svelte-h":!0}),ht(O)!=="svelte-1d0ufga"&&(O.innerHTML=q),vt.forEach(Z),U=z(tt),G=F(tt,"IMG",{src:!0,alt:!0,class:!0}),d=z(tt),g=F(tt,"DIV",{class:!0,"data-svelte-h":!0}),ht(g)!=="svelte-17v6rzn"&&(g.innerHTML=_),tt.forEach(Z),this.h()},h(){ai(s.src,o="/dot.svg")||k(s,"src",o),k(i,"href","#cloud"),k(i,"class","flex items-center justify-center gap-2 rounded-full bg-slate-800 px-3 py-1 text-sm text-slate-300 ring-1 ring-slate-500 transition-all duration-500 hover:bg-slate-700 sm:text-base"),k(E,"class","mt-16 text-5xl font-extralight text-slate-400 sm:text-center md:text-6xl"),k(D,"class","text-xl font-light text-slate-400 sm:text-2xl"),k(O,"class","relative mt-10"),k(e,"class","relative z-10 flex flex-col items-center justify-center gap-4 px-4 pt-32 sm:px-0 md:pt-28"),ai(G.src,y=Pl)||k(G,"src",y),k(G,"alt","Ring"),k(G,"class","absolute left-1/2 top-32 z-0 -translate-x-1/2 md:top-28"),k(g,"class","mt-20 w-full"),k(t,"class","min-h-screen w-full overflow-hidden svelte-rr5ju9")},m(m,tt){ie(m,t,tt),V(t,e),V(e,i),V(i,s),V(i,l),pt(c,i,null),V(e,p),V(e,E),V(e,S),V(e,D),V(e,B),V(e,O),V(t,U),V(t,G),V(t,d),V(t,g),T=!0},p:Ye,i(m){T||(mt(c.$$.fragment,m),m&&(f||Tn(()=>{f=In(i,wn,{duration:500}),f.start()})),m&&(w||Tn(()=>{w=In(E,wn,{duration:500,delay:300}),w.start()})),m&&(x||Tn(()=>{x=In(D,wn,{duration:500,delay:600}),x.start()})),m&&(X||Tn(()=>{X=In(O,wn,{duration:500,delay:900}),X.start()})),m&&(v||Tn(()=>{v=In(g,wn,{duration:500,delay:1200}),v.start()})),T=!0)},o(m){gt(c.$$.fragment,m),T=!1},d(m){m&&Z(t),_t(c)}}}function Sl(n){return gl(()=>{document.querySelector("#slider-container")}),[]}class bl extends $e{constructor(t){super(),Ue(this,t,Sl,Cl,Fe,{})}}function Vl(n){let t,e,i;return{c(){t=L("input"),this.h()},l(s){t=F(s,"INPUT",{class:!0,placeholder:!0}),this.h()},h(){k(t,"class","rounded-full bg-slate-700 px-4 py-2 text-center text-base font-light text-slate-200 ring-1 ring-slate-500 transition-all duration-500 placeholder:font-light hover:ring-2 focus:bg-slate-600 focus:outline-none"),k(t,"placeholder",n[1])},m(s,o){ie(s,t,o),Ls(t,n[0]),e||(i=[_l(n[2].call(null,t)),Co(t,"input",n[4])],e=!0)},p(s,[o]){o&2&&k(t,"placeholder",s[1]),o&1&&t.value!==s[0]&&Ls(t,s[0])},i:Ye,o:Ye,d(s){s&&Z(t),e=!1,yl(i)}}}function Dl(n,t,e){let{value:i=""}=t,{type:s="text"}=t,{placeholder:o="Type here..."}=t;function l(f){f.type=s}function c(){i=this.value,e(0,i)}return n.$$set=f=>{"value"in f&&e(0,i=f.value),"type"in f&&e(3,s=f.type),"placeholder"in f&&e(1,o=f.placeholder)},[i,o,l,s,c]}class Bs extends $e{constructor(t){super(),Ue(this,t,Dl,Vl,Fe,{value:0,type:3,placeholder:1})}}var js={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},xl=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const s=n[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[e++];t[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[e++],l=n[e++],c=n[e++],f=((s&7)<<18|(o&63)<<12|(l&63)<<6|c&63)-65536;t[i++]=String.fromCharCode(55296+(f>>10)),t[i++]=String.fromCharCode(56320+(f&1023))}else{const o=n[e++],l=n[e++];t[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return t.join("")},bo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],l=s+1<n.length,c=l?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,E=o>>2,R=(o&3)<<4|c>>4;let w=(c&15)<<2|p>>6,S=p&63;f||(S=64,l||(w=64)),i.push(e[E],e[R],e[w],e[S])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(So(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):xl(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=e[n.charAt(s++)],c=s<n.length?e[n.charAt(s)]:0;++s;const p=s<n.length?e[n.charAt(s)]:64;++s;const R=s<n.length?e[n.charAt(s)]:64;if(++s,o==null||c==null||p==null||R==null)throw new Nl;const w=o<<2|c>>4;if(i.push(w),p!==64){const S=c<<4&240|p>>2;if(i.push(S),R!==64){const D=p<<6&192|R;i.push(D)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Nl extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kl=function(n){const t=So(n);return bo.encodeByteArray(t,!0)},dr=function(n){return kl(n).replace(/\./g,"")},Ml=function(n){try{return bo.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ol(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ll=()=>Ol().__FIREBASE_DEFAULTS__,Fl=()=>{if(typeof process>"u"||typeof js>"u")return;const n=js.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$l=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Ml(n[1]);return t&&JSON.parse(t)},wi=()=>{try{return Ll()||Fl()||$l()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ul=n=>{var t,e;return(e=(t=wi())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},Bl=n=>{const t=Ul(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},Vo=()=>{var n;return(n=wi())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zl(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[dr(JSON.stringify(e)),dr(JSON.stringify(l)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ql(){var n;const t=(n=wi())===null||n===void 0?void 0:n.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Gl(){return!ql()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Kl(){try{return typeof indexedDB=="object"}catch{return!1}}function Ql(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var o;t(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl="FirebaseError";class rn extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=Wl,Object.setPrototypeOf(this,rn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Do.prototype.create)}}class Do{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},s=`${this.service}/${t}`,o=this.errors[t],l=o?Xl(o,i):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new rn(s,c,i)}}function Xl(n,t){return n.replace(Yl,(e,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const Yl=/\{\$([^}]+)}/g;function li(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const s of e){if(!i.includes(s))return!1;const o=n[s],l=t[s];if(zs(o)&&zs(l)){if(!li(o,l))return!1}else if(o!==l)return!1}for(const s of i)if(!e.includes(s))return!1;return!0}function zs(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dn(n){return n&&n._delegate?n._delegate:n}class xn{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ve="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new jl;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t==null?void 0:t.identifier),s=(e=t==null?void 0:t.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(tu(t))try{this.getOrInitializeService({instanceIdentifier:Ve})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(t=Ve){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Ve){return this.instances.has(t)}getOptions(t=Ve){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[o,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);i===c&&l.resolve(s)}return s}onInit(t,e){var i;const s=this.normalizeInstanceIdentifier(e),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(t),this.onInitCallbacks.set(s,o);const l=this.instances.get(s);return l&&t(l,s),()=>{o.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:Zl(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Ve){return this.component?this.component.multipleInstances?t:Ve:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Zl(n){return n===Ve?void 0:n}function tu(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new Jl(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Y;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Y||(Y={}));const nu={debug:Y.DEBUG,verbose:Y.VERBOSE,info:Y.INFO,warn:Y.WARN,error:Y.ERROR,silent:Y.SILENT},ru=Y.INFO,iu={[Y.DEBUG]:"log",[Y.VERBOSE]:"log",[Y.INFO]:"info",[Y.WARN]:"warn",[Y.ERROR]:"error"},su=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),s=iu[t];if(s)console[s](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class xo{constructor(t){this.name=t,this._logLevel=ru,this._logHandler=su,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Y))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?nu[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Y.DEBUG,...t),this._logHandler(this,Y.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Y.VERBOSE,...t),this._logHandler(this,Y.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Y.INFO,...t),this._logHandler(this,Y.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Y.WARN,...t),this._logHandler(this,Y.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Y.ERROR,...t),this._logHandler(this,Y.ERROR,...t)}}const ou=(n,t)=>t.some(e=>n instanceof e);let Hs,qs;function au(){return Hs||(Hs=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function lu(){return qs||(qs=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const No=new WeakMap,ui=new WeakMap,ko=new WeakMap,ti=new WeakMap,Ai=new WeakMap;function uu(n){const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",l)},o=()=>{e(ve(n.result)),s()},l=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",l)});return t.then(e=>{e instanceof IDBCursor&&No.set(e,n)}).catch(()=>{}),Ai.set(t,n),t}function cu(n){if(ui.has(n))return;const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",l),n.removeEventListener("abort",l)},o=()=>{e(),s()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",l),n.addEventListener("abort",l)});ui.set(n,t)}let ci={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return ui.get(n);if(t==="objectStoreNames")return n.objectStoreNames||ko.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return ve(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function hu(n){ci=n(ci)}function fu(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(ei(this),t,...e);return ko.set(i,t.sort?t.sort():[t]),ve(i)}:lu().includes(n)?function(...t){return n.apply(ei(this),t),ve(No.get(this))}:function(...t){return ve(n.apply(ei(this),t))}}function du(n){return typeof n=="function"?fu(n):(n instanceof IDBTransaction&&cu(n),ou(n,au())?new Proxy(n,ci):n)}function ve(n){if(n instanceof IDBRequest)return uu(n);if(ti.has(n))return ti.get(n);const t=du(n);return t!==n&&(ti.set(n,t),Ai.set(t,n)),t}const ei=n=>Ai.get(n);function pu(n,t,{blocked:e,upgrade:i,blocking:s,terminated:o}={}){const l=indexedDB.open(n,t),c=ve(l);return i&&l.addEventListener("upgradeneeded",f=>{i(ve(l.result),f.oldVersion,f.newVersion,ve(l.transaction),f)}),e&&l.addEventListener("blocked",f=>e(f.oldVersion,f.newVersion,f)),c.then(f=>{o&&f.addEventListener("close",()=>o()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}const mu=["get","getKey","getAll","getAllKeys","count"],gu=["put","add","delete","clear"],ni=new Map;function Gs(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(ni.get(t))return ni.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,s=gu.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||mu.includes(e)))return;const o=async function(l,...c){const f=this.transaction(l,s?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(c.shift())),(await Promise.all([p[e](...c),s&&f.done]))[0]};return ni.set(t,o),o}hu(n=>({...n,get:(t,e,i)=>Gs(t,e)||n.get(t,e,i),has:(t,e)=>!!Gs(t,e)||n.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(yu(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function yu(n){const t=n.getComponent();return(t==null?void 0:t.type)==="VERSION"}const hi="@firebase/app",Ks="0.10.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ke=new xo("@firebase/app"),vu="@firebase/app-compat",Eu="@firebase/analytics-compat",Tu="@firebase/analytics",Iu="@firebase/app-check-compat",wu="@firebase/app-check",Au="@firebase/auth",Ru="@firebase/auth-compat",Pu="@firebase/database",Cu="@firebase/database-compat",Su="@firebase/functions",bu="@firebase/functions-compat",Vu="@firebase/installations",Du="@firebase/installations-compat",xu="@firebase/messaging",Nu="@firebase/messaging-compat",ku="@firebase/performance",Mu="@firebase/performance-compat",Ou="@firebase/remote-config",Lu="@firebase/remote-config-compat",Fu="@firebase/storage",$u="@firebase/storage-compat",Uu="@firebase/firestore",Bu="@firebase/vertexai-preview",ju="@firebase/firestore-compat",zu="firebase",Hu="10.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi="[DEFAULT]",qu={[hi]:"fire-core",[vu]:"fire-core-compat",[Tu]:"fire-analytics",[Eu]:"fire-analytics-compat",[wu]:"fire-app-check",[Iu]:"fire-app-check-compat",[Au]:"fire-auth",[Ru]:"fire-auth-compat",[Pu]:"fire-rtdb",[Cu]:"fire-rtdb-compat",[Su]:"fire-fn",[bu]:"fire-fn-compat",[Vu]:"fire-iid",[Du]:"fire-iid-compat",[xu]:"fire-fcm",[Nu]:"fire-fcm-compat",[ku]:"fire-perf",[Mu]:"fire-perf-compat",[Ou]:"fire-rc",[Lu]:"fire-rc-compat",[Fu]:"fire-gcs",[$u]:"fire-gcs-compat",[Uu]:"fire-fst",[ju]:"fire-fst-compat",[Bu]:"fire-vertex","fire-js":"fire-js",[zu]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr=new Map,Gu=new Map,di=new Map;function Qs(n,t){try{n.container.addComponent(t)}catch(e){ke.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function mr(n){const t=n.name;if(di.has(t))return ke.debug(`There were multiple attempts to register component ${t}.`),!1;di.set(t,n);for(const e of pr.values())Qs(e,n);for(const e of Gu.values())Qs(e,n);return!0}function Ku(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ee=new Do("app","Firebase",Qu);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Ee.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu=Hu;function Mo(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i=Object.assign({name:fi,automaticDataCollectionEnabled:!1},t),s=i.name;if(typeof s!="string"||!s)throw Ee.create("bad-app-name",{appName:String(s)});if(e||(e=Vo()),!e)throw Ee.create("no-options");const o=pr.get(s);if(o){if(li(e,o.options)&&li(i,o.config))return o;throw Ee.create("duplicate-app",{appName:s})}const l=new eu(s);for(const f of di.values())l.addComponent(f);const c=new Wu(e,i,l);return pr.set(s,c),c}function Yu(n=fi){const t=pr.get(n);if(!t&&n===fi&&Vo())return Mo();if(!t)throw Ee.create("no-app",{appName:n});return t}function We(n,t,e){var i;let s=(i=qu[n])!==null&&i!==void 0?i:n;e&&(s+=`-${e}`);const o=s.match(/\s|\//),l=t.match(/\s|\//);if(o||l){const c=[`Unable to register library "${s}" with version "${t}":`];o&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&l&&c.push("and"),l&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ke.warn(c.join(" "));return}mr(new xn(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju="firebase-heartbeat-database",Zu=1,Nn="firebase-heartbeat-store";let ri=null;function Oo(){return ri||(ri=pu(Ju,Zu,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Nn)}catch(e){console.warn(e)}}}}).catch(n=>{throw Ee.create("idb-open",{originalErrorMessage:n.message})})),ri}async function tc(n){try{const e=(await Oo()).transaction(Nn),i=await e.objectStore(Nn).get(Lo(n));return await e.done,i}catch(t){if(t instanceof rn)ke.warn(t.message);else{const e=Ee.create("idb-get",{originalErrorMessage:t==null?void 0:t.message});ke.warn(e.message)}}}async function Ws(n,t){try{const i=(await Oo()).transaction(Nn,"readwrite");await i.objectStore(Nn).put(t,Lo(n)),await i.done}catch(e){if(e instanceof rn)ke.warn(e.message);else{const i=Ee.create("idb-set",{originalErrorMessage:e==null?void 0:e.message});ke.warn(i.message)}}}function Lo(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec=1024,nc=30*24*60*60*1e3;class rc{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new sc(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,e;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Xs();if(!(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(l=>l.date===o)))return this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(l=>{const c=new Date(l.date).valueOf();return Date.now()-c<=nc}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Xs(),{heartbeatsToSend:i,unsentEntries:s}=ic(this._heartbeatsCache.heartbeats),o=dr(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function Xs(){return new Date().toISOString().substring(0,10)}function ic(n,t=ec){const e=[];let i=n.slice();for(const s of n){const o=e.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),Ys(e)>t){o.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Ys(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class sc{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Kl()?Ql().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await tc(this.app);return e!=null&&e.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ws(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ws(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function Ys(n){return dr(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(n){mr(new xn("platform-logger",t=>new _u(t),"PRIVATE")),mr(new xn("heartbeat",t=>new rc(t),"PRIVATE")),We(hi,Ks,n),We(hi,Ks,"esm2017"),We("fire-js","")}oc("");var Js=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fo;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function t(y,d){function g(){}g.prototype=d.prototype,y.D=d.prototype,y.prototype=new g,y.prototype.constructor=y,y.C=function(_,v,T){for(var m=Array(arguments.length-2),tt=2;tt<arguments.length;tt++)m[tt-2]=arguments[tt];return d.prototype[v].apply(_,m)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,e),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(y,d,g){g||(g=0);var _=Array(16);if(typeof d=="string")for(var v=0;16>v;++v)_[v]=d.charCodeAt(g++)|d.charCodeAt(g++)<<8|d.charCodeAt(g++)<<16|d.charCodeAt(g++)<<24;else for(v=0;16>v;++v)_[v]=d[g++]|d[g++]<<8|d[g++]<<16|d[g++]<<24;d=y.g[0],g=y.g[1],v=y.g[2];var T=y.g[3],m=d+(T^g&(v^T))+_[0]+3614090360&4294967295;d=g+(m<<7&4294967295|m>>>25),m=T+(v^d&(g^v))+_[1]+3905402710&4294967295,T=d+(m<<12&4294967295|m>>>20),m=v+(g^T&(d^g))+_[2]+606105819&4294967295,v=T+(m<<17&4294967295|m>>>15),m=g+(d^v&(T^d))+_[3]+3250441966&4294967295,g=v+(m<<22&4294967295|m>>>10),m=d+(T^g&(v^T))+_[4]+4118548399&4294967295,d=g+(m<<7&4294967295|m>>>25),m=T+(v^d&(g^v))+_[5]+1200080426&4294967295,T=d+(m<<12&4294967295|m>>>20),m=v+(g^T&(d^g))+_[6]+2821735955&4294967295,v=T+(m<<17&4294967295|m>>>15),m=g+(d^v&(T^d))+_[7]+4249261313&4294967295,g=v+(m<<22&4294967295|m>>>10),m=d+(T^g&(v^T))+_[8]+1770035416&4294967295,d=g+(m<<7&4294967295|m>>>25),m=T+(v^d&(g^v))+_[9]+2336552879&4294967295,T=d+(m<<12&4294967295|m>>>20),m=v+(g^T&(d^g))+_[10]+4294925233&4294967295,v=T+(m<<17&4294967295|m>>>15),m=g+(d^v&(T^d))+_[11]+2304563134&4294967295,g=v+(m<<22&4294967295|m>>>10),m=d+(T^g&(v^T))+_[12]+1804603682&4294967295,d=g+(m<<7&4294967295|m>>>25),m=T+(v^d&(g^v))+_[13]+4254626195&4294967295,T=d+(m<<12&4294967295|m>>>20),m=v+(g^T&(d^g))+_[14]+2792965006&4294967295,v=T+(m<<17&4294967295|m>>>15),m=g+(d^v&(T^d))+_[15]+1236535329&4294967295,g=v+(m<<22&4294967295|m>>>10),m=d+(v^T&(g^v))+_[1]+4129170786&4294967295,d=g+(m<<5&4294967295|m>>>27),m=T+(g^v&(d^g))+_[6]+3225465664&4294967295,T=d+(m<<9&4294967295|m>>>23),m=v+(d^g&(T^d))+_[11]+643717713&4294967295,v=T+(m<<14&4294967295|m>>>18),m=g+(T^d&(v^T))+_[0]+3921069994&4294967295,g=v+(m<<20&4294967295|m>>>12),m=d+(v^T&(g^v))+_[5]+3593408605&4294967295,d=g+(m<<5&4294967295|m>>>27),m=T+(g^v&(d^g))+_[10]+38016083&4294967295,T=d+(m<<9&4294967295|m>>>23),m=v+(d^g&(T^d))+_[15]+3634488961&4294967295,v=T+(m<<14&4294967295|m>>>18),m=g+(T^d&(v^T))+_[4]+3889429448&4294967295,g=v+(m<<20&4294967295|m>>>12),m=d+(v^T&(g^v))+_[9]+568446438&4294967295,d=g+(m<<5&4294967295|m>>>27),m=T+(g^v&(d^g))+_[14]+3275163606&4294967295,T=d+(m<<9&4294967295|m>>>23),m=v+(d^g&(T^d))+_[3]+4107603335&4294967295,v=T+(m<<14&4294967295|m>>>18),m=g+(T^d&(v^T))+_[8]+1163531501&4294967295,g=v+(m<<20&4294967295|m>>>12),m=d+(v^T&(g^v))+_[13]+2850285829&4294967295,d=g+(m<<5&4294967295|m>>>27),m=T+(g^v&(d^g))+_[2]+4243563512&4294967295,T=d+(m<<9&4294967295|m>>>23),m=v+(d^g&(T^d))+_[7]+1735328473&4294967295,v=T+(m<<14&4294967295|m>>>18),m=g+(T^d&(v^T))+_[12]+2368359562&4294967295,g=v+(m<<20&4294967295|m>>>12),m=d+(g^v^T)+_[5]+4294588738&4294967295,d=g+(m<<4&4294967295|m>>>28),m=T+(d^g^v)+_[8]+2272392833&4294967295,T=d+(m<<11&4294967295|m>>>21),m=v+(T^d^g)+_[11]+1839030562&4294967295,v=T+(m<<16&4294967295|m>>>16),m=g+(v^T^d)+_[14]+4259657740&4294967295,g=v+(m<<23&4294967295|m>>>9),m=d+(g^v^T)+_[1]+2763975236&4294967295,d=g+(m<<4&4294967295|m>>>28),m=T+(d^g^v)+_[4]+1272893353&4294967295,T=d+(m<<11&4294967295|m>>>21),m=v+(T^d^g)+_[7]+4139469664&4294967295,v=T+(m<<16&4294967295|m>>>16),m=g+(v^T^d)+_[10]+3200236656&4294967295,g=v+(m<<23&4294967295|m>>>9),m=d+(g^v^T)+_[13]+681279174&4294967295,d=g+(m<<4&4294967295|m>>>28),m=T+(d^g^v)+_[0]+3936430074&4294967295,T=d+(m<<11&4294967295|m>>>21),m=v+(T^d^g)+_[3]+3572445317&4294967295,v=T+(m<<16&4294967295|m>>>16),m=g+(v^T^d)+_[6]+76029189&4294967295,g=v+(m<<23&4294967295|m>>>9),m=d+(g^v^T)+_[9]+3654602809&4294967295,d=g+(m<<4&4294967295|m>>>28),m=T+(d^g^v)+_[12]+3873151461&4294967295,T=d+(m<<11&4294967295|m>>>21),m=v+(T^d^g)+_[15]+530742520&4294967295,v=T+(m<<16&4294967295|m>>>16),m=g+(v^T^d)+_[2]+3299628645&4294967295,g=v+(m<<23&4294967295|m>>>9),m=d+(v^(g|~T))+_[0]+4096336452&4294967295,d=g+(m<<6&4294967295|m>>>26),m=T+(g^(d|~v))+_[7]+1126891415&4294967295,T=d+(m<<10&4294967295|m>>>22),m=v+(d^(T|~g))+_[14]+2878612391&4294967295,v=T+(m<<15&4294967295|m>>>17),m=g+(T^(v|~d))+_[5]+4237533241&4294967295,g=v+(m<<21&4294967295|m>>>11),m=d+(v^(g|~T))+_[12]+1700485571&4294967295,d=g+(m<<6&4294967295|m>>>26),m=T+(g^(d|~v))+_[3]+2399980690&4294967295,T=d+(m<<10&4294967295|m>>>22),m=v+(d^(T|~g))+_[10]+4293915773&4294967295,v=T+(m<<15&4294967295|m>>>17),m=g+(T^(v|~d))+_[1]+2240044497&4294967295,g=v+(m<<21&4294967295|m>>>11),m=d+(v^(g|~T))+_[8]+1873313359&4294967295,d=g+(m<<6&4294967295|m>>>26),m=T+(g^(d|~v))+_[15]+4264355552&4294967295,T=d+(m<<10&4294967295|m>>>22),m=v+(d^(T|~g))+_[6]+2734768916&4294967295,v=T+(m<<15&4294967295|m>>>17),m=g+(T^(v|~d))+_[13]+1309151649&4294967295,g=v+(m<<21&4294967295|m>>>11),m=d+(v^(g|~T))+_[4]+4149444226&4294967295,d=g+(m<<6&4294967295|m>>>26),m=T+(g^(d|~v))+_[11]+3174756917&4294967295,T=d+(m<<10&4294967295|m>>>22),m=v+(d^(T|~g))+_[2]+718787259&4294967295,v=T+(m<<15&4294967295|m>>>17),m=g+(T^(v|~d))+_[9]+3951481745&4294967295,y.g[0]=y.g[0]+d&4294967295,y.g[1]=y.g[1]+(v+(m<<21&4294967295|m>>>11))&4294967295,y.g[2]=y.g[2]+v&4294967295,y.g[3]=y.g[3]+T&4294967295}i.prototype.u=function(y,d){d===void 0&&(d=y.length);for(var g=d-this.blockSize,_=this.B,v=this.h,T=0;T<d;){if(v==0)for(;T<=g;)s(this,y,T),T+=this.blockSize;if(typeof y=="string"){for(;T<d;)if(_[v++]=y.charCodeAt(T++),v==this.blockSize){s(this,_),v=0;break}}else for(;T<d;)if(_[v++]=y[T++],v==this.blockSize){s(this,_),v=0;break}}this.h=v,this.o+=d},i.prototype.v=function(){var y=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);y[0]=128;for(var d=1;d<y.length-8;++d)y[d]=0;var g=8*this.o;for(d=y.length-8;d<y.length;++d)y[d]=g&255,g/=256;for(this.u(y),y=Array(16),d=g=0;4>d;++d)for(var _=0;32>_;_+=8)y[g++]=this.g[d]>>>_&255;return y};function o(y,d){var g=c;return Object.prototype.hasOwnProperty.call(g,y)?g[y]:g[y]=d(y)}function l(y,d){this.h=d;for(var g=[],_=!0,v=y.length-1;0<=v;v--){var T=y[v]|0;_&&T==d||(g[v]=T,_=!1)}this.g=g}var c={};function f(y){return-128<=y&&128>y?o(y,function(d){return new l([d|0],0>d?-1:0)}):new l([y|0],0>y?-1:0)}function p(y){if(isNaN(y)||!isFinite(y))return R;if(0>y)return x(p(-y));for(var d=[],g=1,_=0;y>=g;_++)d[_]=y/g|0,g*=4294967296;return new l(d,0)}function E(y,d){if(y.length==0)throw Error("number format error: empty string");if(d=d||10,2>d||36<d)throw Error("radix out of range: "+d);if(y.charAt(0)=="-")return x(E(y.substring(1),d));if(0<=y.indexOf("-"))throw Error('number format error: interior "-" character');for(var g=p(Math.pow(d,8)),_=R,v=0;v<y.length;v+=8){var T=Math.min(8,y.length-v),m=parseInt(y.substring(v,v+T),d);8>T?(T=p(Math.pow(d,T)),_=_.j(T).add(p(m))):(_=_.j(g),_=_.add(p(m)))}return _}var R=f(0),w=f(1),S=f(16777216);n=l.prototype,n.m=function(){if(N(this))return-x(this).m();for(var y=0,d=1,g=0;g<this.g.length;g++){var _=this.i(g);y+=(0<=_?_:4294967296+_)*d,d*=4294967296}return y},n.toString=function(y){if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(D(this))return"0";if(N(this))return"-"+x(this).toString(y);for(var d=p(Math.pow(y,6)),g=this,_="";;){var v=X(g,d).g;g=B(g,v.j(d));var T=((0<g.g.length?g.g[0]:g.h)>>>0).toString(y);if(g=v,D(g))return T+_;for(;6>T.length;)T="0"+T;_=T+_}},n.i=function(y){return 0>y?0:y<this.g.length?this.g[y]:this.h};function D(y){if(y.h!=0)return!1;for(var d=0;d<y.g.length;d++)if(y.g[d]!=0)return!1;return!0}function N(y){return y.h==-1}n.l=function(y){return y=B(this,y),N(y)?-1:D(y)?0:1};function x(y){for(var d=y.g.length,g=[],_=0;_<d;_++)g[_]=~y.g[_];return new l(g,~y.h).add(w)}n.abs=function(){return N(this)?x(this):this},n.add=function(y){for(var d=Math.max(this.g.length,y.g.length),g=[],_=0,v=0;v<=d;v++){var T=_+(this.i(v)&65535)+(y.i(v)&65535),m=(T>>>16)+(this.i(v)>>>16)+(y.i(v)>>>16);_=m>>>16,T&=65535,m&=65535,g[v]=m<<16|T}return new l(g,g[g.length-1]&-2147483648?-1:0)};function B(y,d){return y.add(x(d))}n.j=function(y){if(D(this)||D(y))return R;if(N(this))return N(y)?x(this).j(x(y)):x(x(this).j(y));if(N(y))return x(this.j(x(y)));if(0>this.l(S)&&0>y.l(S))return p(this.m()*y.m());for(var d=this.g.length+y.g.length,g=[],_=0;_<2*d;_++)g[_]=0;for(_=0;_<this.g.length;_++)for(var v=0;v<y.g.length;v++){var T=this.i(_)>>>16,m=this.i(_)&65535,tt=y.i(v)>>>16,vt=y.i(v)&65535;g[2*_+2*v]+=m*vt,O(g,2*_+2*v),g[2*_+2*v+1]+=T*vt,O(g,2*_+2*v+1),g[2*_+2*v+1]+=m*tt,O(g,2*_+2*v+1),g[2*_+2*v+2]+=T*tt,O(g,2*_+2*v+2)}for(_=0;_<d;_++)g[_]=g[2*_+1]<<16|g[2*_];for(_=d;_<2*d;_++)g[_]=0;return new l(g,0)};function O(y,d){for(;(y[d]&65535)!=y[d];)y[d+1]+=y[d]>>>16,y[d]&=65535,d++}function q(y,d){this.g=y,this.h=d}function X(y,d){if(D(d))throw Error("division by zero");if(D(y))return new q(R,R);if(N(y))return d=X(x(y),d),new q(x(d.g),x(d.h));if(N(d))return d=X(y,x(d)),new q(x(d.g),d.h);if(30<y.g.length){if(N(y)||N(d))throw Error("slowDivide_ only works with positive integers.");for(var g=w,_=d;0>=_.l(y);)g=U(g),_=U(_);var v=G(g,1),T=G(_,1);for(_=G(_,2),g=G(g,2);!D(_);){var m=T.add(_);0>=m.l(y)&&(v=v.add(g),T=m),_=G(_,1),g=G(g,1)}return d=B(y,v.j(d)),new q(v,d)}for(v=R;0<=y.l(d);){for(g=Math.max(1,Math.floor(y.m()/d.m())),_=Math.ceil(Math.log(g)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),T=p(g),m=T.j(d);N(m)||0<m.l(y);)g-=_,T=p(g),m=T.j(d);D(T)&&(T=w),v=v.add(T),y=B(y,m)}return new q(v,y)}n.A=function(y){return X(this,y).h},n.and=function(y){for(var d=Math.max(this.g.length,y.g.length),g=[],_=0;_<d;_++)g[_]=this.i(_)&y.i(_);return new l(g,this.h&y.h)},n.or=function(y){for(var d=Math.max(this.g.length,y.g.length),g=[],_=0;_<d;_++)g[_]=this.i(_)|y.i(_);return new l(g,this.h|y.h)},n.xor=function(y){for(var d=Math.max(this.g.length,y.g.length),g=[],_=0;_<d;_++)g[_]=this.i(_)^y.i(_);return new l(g,this.h^y.h)};function U(y){for(var d=y.g.length+1,g=[],_=0;_<d;_++)g[_]=y.i(_)<<1|y.i(_-1)>>>31;return new l(g,y.h)}function G(y,d){var g=d>>5;d%=32;for(var _=y.g.length-g,v=[],T=0;T<_;T++)v[T]=0<d?y.i(T+g)>>>d|y.i(T+g+1)<<32-d:y.i(T+g);return new l(v,y.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=E,Fo=l}).apply(typeof Js<"u"?Js:typeof self<"u"?self:typeof window<"u"?window:{});var sr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $o,Uo,Pn,Bo,cr,pi,jo,zo,Ho;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(r,a,u){return r==Array.prototype||r==Object.prototype||(r[a]=u.value),r};function e(r){r=[typeof globalThis=="object"&&globalThis,r,typeof window=="object"&&window,typeof self=="object"&&self,typeof sr=="object"&&sr];for(var a=0;a<r.length;++a){var u=r[a];if(u&&u.Math==Math)return u}throw Error("Cannot find global object")}var i=e(this);function s(r,a){if(a)t:{var u=i;r=r.split(".");for(var h=0;h<r.length-1;h++){var I=r[h];if(!(I in u))break t;u=u[I]}r=r[r.length-1],h=u[r],a=a(h),a!=h&&a!=null&&t(u,r,{configurable:!0,writable:!0,value:a})}}function o(r,a){r instanceof String&&(r+="");var u=0,h=!1,I={next:function(){if(!h&&u<r.length){var A=u++;return{value:a(A,r[A]),done:!1}}return h=!0,{done:!0,value:void 0}}};return I[Symbol.iterator]=function(){return I},I}s("Array.prototype.values",function(r){return r||function(){return o(this,function(a,u){return u})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function f(r){var a=typeof r;return a=a!="object"?a:r?Array.isArray(r)?"array":a:"null",a=="array"||a=="object"&&typeof r.length=="number"}function p(r){var a=typeof r;return a=="object"&&r!=null||a=="function"}function E(r,a,u){return r.call.apply(r.bind,arguments)}function R(r,a,u){if(!r)throw Error();if(2<arguments.length){var h=Array.prototype.slice.call(arguments,2);return function(){var I=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(I,h),r.apply(a,I)}}return function(){return r.apply(a,arguments)}}function w(r,a,u){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?E:R,w.apply(null,arguments)}function S(r,a){var u=Array.prototype.slice.call(arguments,1);return function(){var h=u.slice();return h.push.apply(h,arguments),r.apply(this,h)}}function D(r,a){function u(){}u.prototype=a.prototype,r.aa=a.prototype,r.prototype=new u,r.prototype.constructor=r,r.Qb=function(h,I,A){for(var b=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)b[nt-2]=arguments[nt];return a.prototype[I].apply(h,b)}}function N(r){const a=r.length;if(0<a){const u=Array(a);for(let h=0;h<a;h++)u[h]=r[h];return u}return[]}function x(r,a){for(let u=1;u<arguments.length;u++){const h=arguments[u];if(f(h)){const I=r.length||0,A=h.length||0;r.length=I+A;for(let b=0;b<A;b++)r[I+b]=h[b]}else r.push(h)}}class B{constructor(a,u){this.i=a,this.j=u,this.h=0,this.g=null}get(){let a;return 0<this.h?(this.h--,a=this.g,this.g=a.next,a.next=null):a=this.i(),a}}function O(r){return/^[\s\xa0]*$/.test(r)}function q(){var r=c.navigator;return r&&(r=r.userAgent)?r:""}function X(r){return X[" "](r),r}X[" "]=function(){};var U=q().indexOf("Gecko")!=-1&&!(q().toLowerCase().indexOf("webkit")!=-1&&q().indexOf("Edge")==-1)&&!(q().indexOf("Trident")!=-1||q().indexOf("MSIE")!=-1)&&q().indexOf("Edge")==-1;function G(r,a,u){for(const h in r)a.call(u,r[h],h,r)}function y(r,a){for(const u in r)a.call(void 0,r[u],u,r)}function d(r){const a={};for(const u in r)a[u]=r[u];return a}const g="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(r,a){let u,h;for(let I=1;I<arguments.length;I++){h=arguments[I];for(u in h)r[u]=h[u];for(let A=0;A<g.length;A++)u=g[A],Object.prototype.hasOwnProperty.call(h,u)&&(r[u]=h[u])}}function v(r){var a=1;r=r.split(":");const u=[];for(;0<a&&r.length;)u.push(r.shift()),a--;return r.length&&u.push(r.join(":")),u}function T(r){c.setTimeout(()=>{throw r},0)}function m(){var r=ee;let a=null;return r.g&&(a=r.g,r.g=r.g.next,r.g||(r.h=null),a.next=null),a}class tt{constructor(){this.h=this.g=null}add(a,u){const h=vt.get();h.set(a,u),this.h?this.h.next=h:this.g=h,this.h=h}}var vt=new B(()=>new It,r=>r.reset());class It{constructor(){this.next=this.g=this.h=null}set(a,u){this.h=a,this.g=u,this.next=null}reset(){this.next=this.g=this.h=null}}let rt,at=!1,ee=new tt,Ht=()=>{const r=c.Promise.resolve(void 0);rt=()=>{r.then(qt)}};var qt=()=>{for(var r;r=m();){try{r.h.call(r.g)}catch(u){T(u)}var a=vt;a.j(r),100>a.h&&(a.h++,r.next=a.g,a.g=r)}at=!1};function xt(){this.s=this.s,this.C=this.C}xt.prototype.s=!1,xt.prototype.ma=function(){this.s||(this.s=!0,this.N())},xt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function et(r,a){this.type=r,this.g=this.target=a,this.defaultPrevented=!1}et.prototype.h=function(){this.defaultPrevented=!0};var Qt=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var r=!1,a=Object.defineProperty({},"passive",{get:function(){r=!0}});try{const u=()=>{};c.addEventListener("test",u,a),c.removeEventListener("test",u,a)}catch{}return r}();function Wt(r,a){if(et.call(this,r?r.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,r){var u=this.type=r.type,h=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:null;if(this.target=r.target||r.srcElement,this.g=a,a=r.relatedTarget){if(U){t:{try{X(a.nodeName);var I=!0;break t}catch{}I=!1}I||(a=null)}}else u=="mouseover"?a=r.fromElement:u=="mouseout"&&(a=r.toElement);this.relatedTarget=a,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=r.button,this.key=r.key||"",this.ctrlKey=r.ctrlKey,this.altKey=r.altKey,this.shiftKey=r.shiftKey,this.metaKey=r.metaKey,this.pointerId=r.pointerId||0,this.pointerType=typeof r.pointerType=="string"?r.pointerType:ut[r.pointerType]||"",this.state=r.state,this.i=r,r.defaultPrevented&&Wt.aa.h.call(this)}}D(Wt,et);var ut={2:"touch",3:"pen",4:"mouse"};Wt.prototype.h=function(){Wt.aa.h.call(this);var r=this.i;r.preventDefault?r.preventDefault():r.returnValue=!1};var Ut="closure_listenable_"+(1e6*Math.random()|0),Xt=0;function ae(r,a,u,h,I){this.listener=r,this.proxy=null,this.src=a,this.type=u,this.capture=!!h,this.ha=I,this.key=++Xt,this.da=this.fa=!1}function Gt(r){r.da=!0,r.listener=null,r.proxy=null,r.src=null,r.ha=null}function Yt(r){this.src=r,this.g={},this.h=0}Yt.prototype.add=function(r,a,u,h,I){var A=r.toString();r=this.g[A],r||(r=this.g[A]=[],this.h++);var b=Q(r,a,h,I);return-1<b?(a=r[b],u||(a.fa=!1)):(a=new ae(a,this.src,A,!!h,I),a.fa=u,r.push(a)),a};function Jt(r,a){var u=a.type;if(u in r.g){var h=r.g[u],I=Array.prototype.indexOf.call(h,a,void 0),A;(A=0<=I)&&Array.prototype.splice.call(h,I,1),A&&(Gt(a),r.g[u].length==0&&(delete r.g[u],r.h--))}}function Q(r,a,u,h){for(var I=0;I<r.length;++I){var A=r[I];if(!A.da&&A.listener==a&&A.capture==!!u&&A.ha==h)return I}return-1}var Zt="closure_lm_"+(1e6*Math.random()|0),Bt={};function wt(r,a,u,h,I){if(Array.isArray(a)){for(var A=0;A<a.length;A++)wt(r,a[A],u,h,I);return null}return u=Bi(u),r&&r[Ut]?r.K(a,u,p(h)?!!h.capture:!!h,I):me(r,a,u,!1,h,I)}function me(r,a,u,h,I,A){if(!a)throw Error("Invalid event type");var b=p(I)?!!I.capture:!!I,nt=Or(r);if(nt||(r[Zt]=nt=new Yt(r)),u=nt.add(a,u,h,b,A),u.proxy)return u;if(h=je(),u.proxy=h,h.src=r,h.listener=u,r.addEventListener)Qt||(I=b),I===void 0&&(I=!1),r.addEventListener(a.toString(),h,I);else if(r.attachEvent)r.attachEvent(Ui(a.toString()),h);else if(r.addListener&&r.removeListener)r.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return u}function je(){function r(u){return a.call(r.src,r.listener,u)}const a=Ba;return r}function Re(r,a,u,h,I){if(Array.isArray(a))for(var A=0;A<a.length;A++)Re(r,a[A],u,h,I);else h=p(h)?!!h.capture:!!h,u=Bi(u),r&&r[Ut]?(r=r.i,a=String(a).toString(),a in r.g&&(A=r.g[a],u=Q(A,u,h,I),-1<u&&(Gt(A[u]),Array.prototype.splice.call(A,u,1),A.length==0&&(delete r.g[a],r.h--)))):r&&(r=Or(r))&&(a=r.g[a.toString()],r=-1,a&&(r=Q(a,u,h,I)),(u=-1<r?a[r]:null)&&Mr(u))}function Mr(r){if(typeof r!="number"&&r&&!r.da){var a=r.src;if(a&&a[Ut])Jt(a.i,r);else{var u=r.type,h=r.proxy;a.removeEventListener?a.removeEventListener(u,h,r.capture):a.detachEvent?a.detachEvent(Ui(u),h):a.addListener&&a.removeListener&&a.removeListener(h),(u=Or(a))?(Jt(u,r),u.h==0&&(u.src=null,a[Zt]=null)):Gt(r)}}}function Ui(r){return r in Bt?Bt[r]:Bt[r]="on"+r}function Ba(r,a){if(r.da)r=!0;else{a=new Wt(a,this);var u=r.listener,h=r.ha||r.src;r.fa&&Mr(r),r=u.call(h,a)}return r}function Or(r){return r=r[Zt],r instanceof Yt?r:null}var Lr="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bi(r){return typeof r=="function"?r:(r[Lr]||(r[Lr]=function(a){return r.handleEvent(a)}),r[Lr])}function Nt(){xt.call(this),this.i=new Yt(this),this.M=this,this.F=null}D(Nt,xt),Nt.prototype[Ut]=!0,Nt.prototype.removeEventListener=function(r,a,u,h){Re(this,r,a,u,h)};function jt(r,a){var u,h=r.F;if(h)for(u=[];h;h=h.F)u.push(h);if(r=r.M,h=a.type||a,typeof a=="string")a=new et(a,r);else if(a instanceof et)a.target=a.target||r;else{var I=a;a=new et(h,r),_(a,I)}if(I=!0,u)for(var A=u.length-1;0<=A;A--){var b=a.g=u[A];I=Hn(b,h,!0,a)&&I}if(b=a.g=r,I=Hn(b,h,!0,a)&&I,I=Hn(b,h,!1,a)&&I,u)for(A=0;A<u.length;A++)b=a.g=u[A],I=Hn(b,h,!1,a)&&I}Nt.prototype.N=function(){if(Nt.aa.N.call(this),this.i){var r=this.i,a;for(a in r.g){for(var u=r.g[a],h=0;h<u.length;h++)Gt(u[h]);delete r.g[a],r.h--}}this.F=null},Nt.prototype.K=function(r,a,u,h){return this.i.add(String(r),a,!1,u,h)},Nt.prototype.L=function(r,a,u,h){return this.i.add(String(r),a,!0,u,h)};function Hn(r,a,u,h){if(a=r.i.g[String(a)],!a)return!0;a=a.concat();for(var I=!0,A=0;A<a.length;++A){var b=a[A];if(b&&!b.da&&b.capture==u){var nt=b.listener,St=b.ha||b.src;b.fa&&Jt(r.i,b),I=nt.call(St,h)!==!1&&I}}return I&&!h.defaultPrevented}function ji(r,a,u){if(typeof r=="function")u&&(r=w(r,u));else if(r&&typeof r.handleEvent=="function")r=w(r.handleEvent,r);else throw Error("Invalid listener argument");return 2147483647<Number(a)?-1:c.setTimeout(r,a||0)}function zi(r){r.g=ji(()=>{r.g=null,r.i&&(r.i=!1,zi(r))},r.l);const a=r.h;r.h=null,r.m.apply(null,a)}class ja extends xt{constructor(a,u){super(),this.m=a,this.l=u,this.h=null,this.i=!1,this.g=null}j(a){this.h=arguments,this.g?this.i=!0:zi(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function an(r){xt.call(this),this.h=r,this.g={}}D(an,xt);var Hi=[];function qi(r){G(r.g,function(a,u){this.g.hasOwnProperty(u)&&Mr(a)},r),r.g={}}an.prototype.N=function(){an.aa.N.call(this),qi(this)},an.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fr=c.JSON.stringify,za=c.JSON.parse,Ha=class{stringify(r){return c.JSON.stringify(r,void 0)}parse(r){return c.JSON.parse(r,void 0)}};function $r(){}$r.prototype.h=null;function Gi(r){return r.h||(r.h=r.i())}function Ki(){}var ln={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ur(){et.call(this,"d")}D(Ur,et);function Br(){et.call(this,"c")}D(Br,et);var Pe={},Qi=null;function qn(){return Qi=Qi||new Nt}Pe.La="serverreachability";function Wi(r){et.call(this,Pe.La,r)}D(Wi,et);function un(r){const a=qn();jt(a,new Wi(a))}Pe.STAT_EVENT="statevent";function Xi(r,a){et.call(this,Pe.STAT_EVENT,r),this.stat=a}D(Xi,et);function zt(r){const a=qn();jt(a,new Xi(a,r))}Pe.Ma="timingevent";function Yi(r,a){et.call(this,Pe.Ma,r),this.size=a}D(Yi,et);function cn(r,a){if(typeof r!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){r()},a)}function hn(){this.g=!0}hn.prototype.xa=function(){this.g=!1};function qa(r,a,u,h,I,A){r.info(function(){if(r.g)if(A)for(var b="",nt=A.split("&"),St=0;St<nt.length;St++){var J=nt[St].split("=");if(1<J.length){var kt=J[0];J=J[1];var Mt=kt.split("_");b=2<=Mt.length&&Mt[1]=="type"?b+(kt+"="+J+"&"):b+(kt+"=redacted&")}}else b=null;else b=A;return"XMLHTTP REQ ("+h+") [attempt "+I+"]: "+a+`
`+u+`
`+b})}function Ga(r,a,u,h,I,A,b){r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+I+"]: "+a+`
`+u+`
`+A+" "+b})}function ze(r,a,u,h){r.info(function(){return"XMLHTTP TEXT ("+a+"): "+Qa(r,u)+(h?" "+h:"")})}function Ka(r,a){r.info(function(){return"TIMEOUT: "+a})}hn.prototype.info=function(){};function Qa(r,a){if(!r.g)return a;if(!a)return null;try{var u=JSON.parse(a);if(u){for(r=0;r<u.length;r++)if(Array.isArray(u[r])){var h=u[r];if(!(2>h.length)){var I=h[1];if(Array.isArray(I)&&!(1>I.length)){var A=I[0];if(A!="noop"&&A!="stop"&&A!="close")for(var b=1;b<I.length;b++)I[b]=""}}}}return Fr(u)}catch{return a}}var Gn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ji={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},jr;function Kn(){}D(Kn,$r),Kn.prototype.g=function(){return new XMLHttpRequest},Kn.prototype.i=function(){return{}},jr=new Kn;function ge(r,a,u,h){this.j=r,this.i=a,this.l=u,this.R=h||1,this.U=new an(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Zi}function Zi(){this.i=null,this.g="",this.h=!1}var ts={},zr={};function Hr(r,a,u){r.L=1,r.v=Yn(he(a)),r.m=u,r.P=!0,es(r,null)}function es(r,a){r.F=Date.now(),Qn(r),r.A=he(r.v);var u=r.A,h=r.R;Array.isArray(h)||(h=[String(h)]),ms(u.i,"t",h),r.C=0,u=r.j.J,r.h=new Zi,r.g=Ns(r.j,u?a:null,!r.m),0<r.O&&(r.M=new ja(w(r.Y,r,r.g),r.O)),a=r.U,u=r.g,h=r.ca;var I="readystatechange";Array.isArray(I)||(I&&(Hi[0]=I.toString()),I=Hi);for(var A=0;A<I.length;A++){var b=wt(u,I[A],h||a.handleEvent,!1,a.h||a);if(!b)break;a.g[b.key]=b}a=r.H?d(r.H):{},r.m?(r.u||(r.u="POST"),a["Content-Type"]="application/x-www-form-urlencoded",r.g.ea(r.A,r.u,r.m,a)):(r.u="GET",r.g.ea(r.A,r.u,null,a)),un(),qa(r.i,r.u,r.A,r.l,r.R,r.m)}ge.prototype.ca=function(r){r=r.target;const a=this.M;a&&fe(r)==3?a.j():this.Y(r)},ge.prototype.Y=function(r){try{if(r==this.g)t:{const Mt=fe(this.g);var a=this.g.Ba();const Ge=this.g.Z();if(!(3>Mt)&&(Mt!=3||this.g&&(this.h.h||this.g.oa()||Is(this.g)))){this.J||Mt!=4||a==7||(a==8||0>=Ge?un(3):un(2)),qr(this);var u=this.g.Z();this.X=u;e:if(ns(this)){var h=Is(this.g);r="";var I=h.length,A=fe(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ce(this),fn(this);var b="";break e}this.h.i=new c.TextDecoder}for(a=0;a<I;a++)this.h.h=!0,r+=this.h.i.decode(h[a],{stream:!(A&&a==I-1)});h.length=0,this.h.g+=r,this.C=0,b=this.h.g}else b=this.g.oa();if(this.o=u==200,Ga(this.i,this.u,this.A,this.l,this.R,Mt,u),this.o){if(this.T&&!this.K){e:{if(this.g){var nt,St=this.g;if((nt=St.g?St.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(nt)){var J=nt;break e}}J=null}if(u=J)ze(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gr(this,u);else{this.o=!1,this.s=3,zt(12),Ce(this),fn(this);break t}}if(this.P){u=!0;let ne;for(;!this.J&&this.C<b.length;)if(ne=Wa(this,b),ne==zr){Mt==4&&(this.s=4,zt(14),u=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}else if(ne==ts){this.s=4,zt(15),ze(this.i,this.l,b,"[Invalid Chunk]"),u=!1;break}else ze(this.i,this.l,ne,null),Gr(this,ne);if(ns(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mt!=4||b.length!=0||this.h.h||(this.s=1,zt(16),u=!1),this.o=this.o&&u,!u)ze(this.i,this.l,b,"[Invalid Chunked Response]"),Ce(this),fn(this);else if(0<b.length&&!this.W){this.W=!0;var kt=this.j;kt.g==this&&kt.ba&&!kt.M&&(kt.j.info("Great, no buffering proxy detected. Bytes received: "+b.length),Jr(kt),kt.M=!0,zt(11))}}else ze(this.i,this.l,b,null),Gr(this,b);Mt==4&&Ce(this),this.o&&!this.J&&(Mt==4?bs(this.j,this):(this.o=!1,Qn(this)))}else fl(this.g),u==400&&0<b.indexOf("Unknown SID")?(this.s=3,zt(12)):(this.s=0,zt(13)),Ce(this),fn(this)}}}catch{}finally{}};function ns(r){return r.g?r.u=="GET"&&r.L!=2&&r.j.Ca:!1}function Wa(r,a){var u=r.C,h=a.indexOf(`
`,u);return h==-1?zr:(u=Number(a.substring(u,h)),isNaN(u)?ts:(h+=1,h+u>a.length?zr:(a=a.slice(h,h+u),r.C=h+u,a)))}ge.prototype.cancel=function(){this.J=!0,Ce(this)};function Qn(r){r.S=Date.now()+r.I,rs(r,r.I)}function rs(r,a){if(r.B!=null)throw Error("WatchDog timer not null");r.B=cn(w(r.ba,r),a)}function qr(r){r.B&&(c.clearTimeout(r.B),r.B=null)}ge.prototype.ba=function(){this.B=null;const r=Date.now();0<=r-this.S?(Ka(this.i,this.A),this.L!=2&&(un(),zt(17)),Ce(this),this.s=2,fn(this)):rs(this,this.S-r)};function fn(r){r.j.G==0||r.J||bs(r.j,r)}function Ce(r){qr(r);var a=r.M;a&&typeof a.ma=="function"&&a.ma(),r.M=null,qi(r.U),r.g&&(a=r.g,r.g=null,a.abort(),a.ma())}function Gr(r,a){try{var u=r.j;if(u.G!=0&&(u.g==r||Kr(u.h,r))){if(!r.K&&Kr(u.h,r)&&u.G==3){try{var h=u.Da.g.parse(a)}catch{h=null}if(Array.isArray(h)&&h.length==3){var I=h;if(I[0]==0){t:if(!u.u){if(u.g)if(u.g.F+3e3<r.F)nr(u),tr(u);else break t;Yr(u),zt(18)}}else u.za=I[1],0<u.za-u.T&&37500>I[2]&&u.F&&u.v==0&&!u.C&&(u.C=cn(w(u.Za,u),6e3));if(1>=os(u.h)&&u.ca){try{u.ca()}catch{}u.ca=void 0}}else be(u,11)}else if((r.K||u.g==r)&&nr(u),!O(a))for(I=u.Da.g.parse(a),a=0;a<I.length;a++){let J=I[a];if(u.T=J[0],J=J[1],u.G==2)if(J[0]=="c"){u.K=J[1],u.ia=J[2];const kt=J[3];kt!=null&&(u.la=kt,u.j.info("VER="+u.la));const Mt=J[4];Mt!=null&&(u.Aa=Mt,u.j.info("SVER="+u.Aa));const Ge=J[5];Ge!=null&&typeof Ge=="number"&&0<Ge&&(h=1.5*Ge,u.L=h,u.j.info("backChannelRequestTimeoutMs_="+h)),h=u;const ne=r.g;if(ne){const ir=ne.g?ne.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ir){var A=h.h;A.g||ir.indexOf("spdy")==-1&&ir.indexOf("quic")==-1&&ir.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(Qr(A,A.h),A.h=null))}if(h.D){const Zr=ne.g?ne.g.getResponseHeader("X-HTTP-Session-Id"):null;Zr&&(h.ya=Zr,st(h.I,h.D,Zr))}}u.G=3,u.l&&u.l.ua(),u.ba&&(u.R=Date.now()-r.F,u.j.info("Handshake RTT: "+u.R+"ms")),h=u;var b=r;if(h.qa=xs(h,h.J?h.ia:null,h.W),b.K){as(h.h,b);var nt=b,St=h.L;St&&(nt.I=St),nt.B&&(qr(nt),Qn(nt)),h.g=b}else Cs(h);0<u.i.length&&er(u)}else J[0]!="stop"&&J[0]!="close"||be(u,7);else u.G==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?be(u,7):Xr(u):J[0]!="noop"&&u.l&&u.l.ta(J),u.v=0)}}un(4)}catch{}}var Xa=class{constructor(r,a){this.g=r,this.map=a}};function is(r){this.l=r||10,c.PerformanceNavigationTiming?(r=c.performance.getEntriesByType("navigation"),r=0<r.length&&(r[0].nextHopProtocol=="hq"||r[0].nextHopProtocol=="h2")):r=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=r?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ss(r){return r.h?!0:r.g?r.g.size>=r.j:!1}function os(r){return r.h?1:r.g?r.g.size:0}function Kr(r,a){return r.h?r.h==a:r.g?r.g.has(a):!1}function Qr(r,a){r.g?r.g.add(a):r.h=a}function as(r,a){r.h&&r.h==a?r.h=null:r.g&&r.g.has(a)&&r.g.delete(a)}is.prototype.cancel=function(){if(this.i=ls(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const r of this.g.values())r.cancel();this.g.clear()}};function ls(r){if(r.h!=null)return r.i.concat(r.h.D);if(r.g!=null&&r.g.size!==0){let a=r.i;for(const u of r.g.values())a=a.concat(u.D);return a}return N(r.i)}function Ya(r){if(r.V&&typeof r.V=="function")return r.V();if(typeof Map<"u"&&r instanceof Map||typeof Set<"u"&&r instanceof Set)return Array.from(r.values());if(typeof r=="string")return r.split("");if(f(r)){for(var a=[],u=r.length,h=0;h<u;h++)a.push(r[h]);return a}a=[],u=0;for(h in r)a[u++]=r[h];return a}function Ja(r){if(r.na&&typeof r.na=="function")return r.na();if(!r.V||typeof r.V!="function"){if(typeof Map<"u"&&r instanceof Map)return Array.from(r.keys());if(!(typeof Set<"u"&&r instanceof Set)){if(f(r)||typeof r=="string"){var a=[];r=r.length;for(var u=0;u<r;u++)a.push(u);return a}a=[],u=0;for(const h in r)a[u++]=h;return a}}}function us(r,a){if(r.forEach&&typeof r.forEach=="function")r.forEach(a,void 0);else if(f(r)||typeof r=="string")Array.prototype.forEach.call(r,a,void 0);else for(var u=Ja(r),h=Ya(r),I=h.length,A=0;A<I;A++)a.call(void 0,h[A],u&&u[A],r)}var cs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Za(r,a){if(r){r=r.split("&");for(var u=0;u<r.length;u++){var h=r[u].indexOf("="),I=null;if(0<=h){var A=r[u].substring(0,h);I=r[u].substring(h+1)}else A=r[u];a(A,I?decodeURIComponent(I.replace(/\+/g," ")):"")}}}function Se(r){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,r instanceof Se){this.h=r.h,Wn(this,r.j),this.o=r.o,this.g=r.g,Xn(this,r.s),this.l=r.l;var a=r.i,u=new mn;u.i=a.i,a.g&&(u.g=new Map(a.g),u.h=a.h),hs(this,u),this.m=r.m}else r&&(a=String(r).match(cs))?(this.h=!1,Wn(this,a[1]||"",!0),this.o=dn(a[2]||""),this.g=dn(a[3]||"",!0),Xn(this,a[4]),this.l=dn(a[5]||"",!0),hs(this,a[6]||"",!0),this.m=dn(a[7]||"")):(this.h=!1,this.i=new mn(null,this.h))}Se.prototype.toString=function(){var r=[],a=this.j;a&&r.push(pn(a,fs,!0),":");var u=this.g;return(u||a=="file")&&(r.push("//"),(a=this.o)&&r.push(pn(a,fs,!0),"@"),r.push(encodeURIComponent(String(u)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u=this.s,u!=null&&r.push(":",String(u))),(u=this.l)&&(this.g&&u.charAt(0)!="/"&&r.push("/"),r.push(pn(u,u.charAt(0)=="/"?nl:el,!0))),(u=this.i.toString())&&r.push("?",u),(u=this.m)&&r.push("#",pn(u,il)),r.join("")};function he(r){return new Se(r)}function Wn(r,a,u){r.j=u?dn(a,!0):a,r.j&&(r.j=r.j.replace(/:$/,""))}function Xn(r,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);r.s=a}else r.s=null}function hs(r,a,u){a instanceof mn?(r.i=a,sl(r.i,r.h)):(u||(a=pn(a,rl)),r.i=new mn(a,r.h))}function st(r,a,u){r.i.set(a,u)}function Yn(r){return st(r,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),r}function dn(r,a){return r?a?decodeURI(r.replace(/%25/g,"%2525")):decodeURIComponent(r):""}function pn(r,a,u){return typeof r=="string"?(r=encodeURI(r).replace(a,tl),u&&(r=r.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),r):null}function tl(r){return r=r.charCodeAt(0),"%"+(r>>4&15).toString(16)+(r&15).toString(16)}var fs=/[#\/\?@]/g,el=/[#\?:]/g,nl=/[#\?]/g,rl=/[#\?@]/g,il=/#/g;function mn(r,a){this.h=this.g=null,this.i=r||null,this.j=!!a}function _e(r){r.g||(r.g=new Map,r.h=0,r.i&&Za(r.i,function(a,u){r.add(decodeURIComponent(a.replace(/\+/g," ")),u)}))}n=mn.prototype,n.add=function(r,a){_e(this),this.i=null,r=He(this,r);var u=this.g.get(r);return u||this.g.set(r,u=[]),u.push(a),this.h+=1,this};function ds(r,a){_e(r),a=He(r,a),r.g.has(a)&&(r.i=null,r.h-=r.g.get(a).length,r.g.delete(a))}function ps(r,a){return _e(r),a=He(r,a),r.g.has(a)}n.forEach=function(r,a){_e(this),this.g.forEach(function(u,h){u.forEach(function(I){r.call(a,I,h,this)},this)},this)},n.na=function(){_e(this);const r=Array.from(this.g.values()),a=Array.from(this.g.keys()),u=[];for(let h=0;h<a.length;h++){const I=r[h];for(let A=0;A<I.length;A++)u.push(a[h])}return u},n.V=function(r){_e(this);let a=[];if(typeof r=="string")ps(this,r)&&(a=a.concat(this.g.get(He(this,r))));else{r=Array.from(this.g.values());for(let u=0;u<r.length;u++)a=a.concat(r[u])}return a},n.set=function(r,a){return _e(this),this.i=null,r=He(this,r),ps(this,r)&&(this.h-=this.g.get(r).length),this.g.set(r,[a]),this.h+=1,this},n.get=function(r,a){return r?(r=this.V(r),0<r.length?String(r[0]):a):a};function ms(r,a,u){ds(r,a),0<u.length&&(r.i=null,r.g.set(He(r,a),N(u)),r.h+=u.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const r=[],a=Array.from(this.g.keys());for(var u=0;u<a.length;u++){var h=a[u];const A=encodeURIComponent(String(h)),b=this.V(h);for(h=0;h<b.length;h++){var I=A;b[h]!==""&&(I+="="+encodeURIComponent(String(b[h]))),r.push(I)}}return this.i=r.join("&")};function He(r,a){return a=String(a),r.j&&(a=a.toLowerCase()),a}function sl(r,a){a&&!r.j&&(_e(r),r.i=null,r.g.forEach(function(u,h){var I=h.toLowerCase();h!=I&&(ds(this,h),ms(this,I,u))},r)),r.j=a}function ol(r,a){const u=new hn;if(c.Image){const h=new Image;h.onload=S(ye,u,"TestLoadImage: loaded",!0,a,h),h.onerror=S(ye,u,"TestLoadImage: error",!1,a,h),h.onabort=S(ye,u,"TestLoadImage: abort",!1,a,h),h.ontimeout=S(ye,u,"TestLoadImage: timeout",!1,a,h),c.setTimeout(function(){h.ontimeout&&h.ontimeout()},1e4),h.src=r}else a(!1)}function al(r,a){const u=new hn,h=new AbortController,I=setTimeout(()=>{h.abort(),ye(u,"TestPingServer: timeout",!1,a)},1e4);fetch(r,{signal:h.signal}).then(A=>{clearTimeout(I),A.ok?ye(u,"TestPingServer: ok",!0,a):ye(u,"TestPingServer: server error",!1,a)}).catch(()=>{clearTimeout(I),ye(u,"TestPingServer: error",!1,a)})}function ye(r,a,u,h,I){try{I&&(I.onload=null,I.onerror=null,I.onabort=null,I.ontimeout=null),h(u)}catch{}}function ll(){this.g=new Ha}function ul(r,a,u){const h=u||"";try{us(r,function(I,A){let b=I;p(I)&&(b=Fr(I)),a.push(h+A+"="+encodeURIComponent(b))})}catch(I){throw a.push(h+"type="+encodeURIComponent("_badmap")),I}}function gn(r){this.l=r.Ub||null,this.j=r.eb||!1}D(gn,$r),gn.prototype.g=function(){return new Jn(this.l,this.j)},gn.prototype.i=function(r){return function(){return r}}({});function Jn(r,a){Nt.call(this),this.D=r,this.o=a,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(Jn,Nt),n=Jn.prototype,n.open=function(r,a){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=r,this.A=a,this.readyState=1,yn(this)},n.send=function(r){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const a={headers:this.u,method:this.B,credentials:this.m,cache:void 0};r&&(a.body=r),(this.D||c).fetch(new Request(this.A,a)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,_n(this)),this.readyState=0},n.Sa=function(r){if(this.g&&(this.l=r,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=r.headers,this.readyState=2,yn(this)),this.g&&(this.readyState=3,yn(this),this.g)))if(this.responseType==="arraybuffer")r.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in r){if(this.j=r.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gs(this)}else r.text().then(this.Ra.bind(this),this.ga.bind(this))};function gs(r){r.j.read().then(r.Pa.bind(r)).catch(r.ga.bind(r))}n.Pa=function(r){if(this.g){if(this.o&&r.value)this.response.push(r.value);else if(!this.o){var a=r.value?r.value:new Uint8Array(0);(a=this.v.decode(a,{stream:!r.done}))&&(this.response=this.responseText+=a)}r.done?_n(this):yn(this),this.readyState==3&&gs(this)}},n.Ra=function(r){this.g&&(this.response=this.responseText=r,_n(this))},n.Qa=function(r){this.g&&(this.response=r,_n(this))},n.ga=function(){this.g&&_n(this)};function _n(r){r.readyState=4,r.l=null,r.j=null,r.v=null,yn(r)}n.setRequestHeader=function(r,a){this.u.append(r,a)},n.getResponseHeader=function(r){return this.h&&this.h.get(r.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const r=[],a=this.h.entries();for(var u=a.next();!u.done;)u=u.value,r.push(u[0]+": "+u[1]),u=a.next();return r.join(`\r
`)};function yn(r){r.onreadystatechange&&r.onreadystatechange.call(r)}Object.defineProperty(Jn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(r){this.m=r?"include":"same-origin"}});function _s(r){let a="";return G(r,function(u,h){a+=h,a+=":",a+=u,a+=`\r
`}),a}function Wr(r,a,u){t:{for(h in u){var h=!1;break t}h=!0}h||(u=_s(u),typeof r=="string"?u!=null&&encodeURIComponent(String(u)):st(r,a,u))}function ct(r){Nt.call(this),this.headers=new Map,this.o=r||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(ct,Nt);var cl=/^https?$/i,hl=["POST","PUT"];n=ct.prototype,n.Ha=function(r){this.J=r},n.ea=function(r,a,u,h){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+r);a=a?a.toUpperCase():"GET",this.D=r,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():jr.g(),this.v=this.o?Gi(this.o):Gi(jr),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(a,String(r),!0),this.B=!1}catch(A){ys(this,A);return}if(r=u||"",u=new Map(this.headers),h)if(Object.getPrototypeOf(h)===Object.prototype)for(var I in h)u.set(I,h[I]);else if(typeof h.keys=="function"&&typeof h.get=="function")for(const A of h.keys())u.set(A,h.get(A));else throw Error("Unknown input type for opt_headers: "+String(h));h=Array.from(u.keys()).find(A=>A.toLowerCase()=="content-type"),I=c.FormData&&r instanceof c.FormData,!(0<=Array.prototype.indexOf.call(hl,a,void 0))||h||I||u.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[A,b]of u)this.g.setRequestHeader(A,b);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ts(this),this.u=!0,this.g.send(r),this.u=!1}catch(A){ys(this,A)}};function ys(r,a){r.h=!1,r.g&&(r.j=!0,r.g.abort(),r.j=!1),r.l=a,r.m=5,vs(r),Zn(r)}function vs(r){r.A||(r.A=!0,jt(r,"complete"),jt(r,"error"))}n.abort=function(r){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=r||7,jt(this,"complete"),jt(this,"abort"),Zn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zn(this,!0)),ct.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Es(this):this.bb())},n.bb=function(){Es(this)};function Es(r){if(r.h&&typeof l<"u"&&(!r.v[1]||fe(r)!=4||r.Z()!=2)){if(r.u&&fe(r)==4)ji(r.Ea,0,r);else if(jt(r,"readystatechange"),fe(r)==4){r.h=!1;try{const b=r.Z();t:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var a=!0;break t;default:a=!1}var u;if(!(u=a)){var h;if(h=b===0){var I=String(r.D).match(cs)[1]||null;!I&&c.self&&c.self.location&&(I=c.self.location.protocol.slice(0,-1)),h=!cl.test(I?I.toLowerCase():"")}u=h}if(u)jt(r,"complete"),jt(r,"success");else{r.m=6;try{var A=2<fe(r)?r.g.statusText:""}catch{A=""}r.l=A+" ["+r.Z()+"]",vs(r)}}finally{Zn(r)}}}}function Zn(r,a){if(r.g){Ts(r);const u=r.g,h=r.v[0]?()=>{}:null;r.g=null,r.v=null,a||jt(r,"ready");try{u.onreadystatechange=h}catch{}}}function Ts(r){r.I&&(c.clearTimeout(r.I),r.I=null)}n.isActive=function(){return!!this.g};function fe(r){return r.g?r.g.readyState:0}n.Z=function(){try{return 2<fe(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(r){if(this.g){var a=this.g.responseText;return r&&a.indexOf(r)==0&&(a=a.substring(r.length)),za(a)}};function Is(r){try{if(!r.g)return null;if("response"in r.g)return r.g.response;switch(r.H){case"":case"text":return r.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in r.g)return r.g.mozResponseArrayBuffer}return null}catch{return null}}function fl(r){const a={};r=(r.g&&2<=fe(r)&&r.g.getAllResponseHeaders()||"").split(`\r
`);for(let h=0;h<r.length;h++){if(O(r[h]))continue;var u=v(r[h]);const I=u[0];if(u=u[1],typeof u!="string")continue;u=u.trim();const A=a[I]||[];a[I]=A,A.push(u)}y(a,function(h){return h.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function vn(r,a,u){return u&&u.internalChannelParams&&u.internalChannelParams[r]||a}function ws(r){this.Aa=0,this.i=[],this.j=new hn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=vn("failFast",!1,r),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=vn("baseRetryDelayMs",5e3,r),this.cb=vn("retryDelaySeedMs",1e4,r),this.Wa=vn("forwardChannelMaxRetries",2,r),this.wa=vn("forwardChannelRequestTimeoutMs",2e4,r),this.pa=r&&r.xmlHttpFactory||void 0,this.Xa=r&&r.Tb||void 0,this.Ca=r&&r.useFetchStreams||!1,this.L=void 0,this.J=r&&r.supportsCrossDomainXhr||!1,this.K="",this.h=new is(r&&r.concurrentRequestLimit),this.Da=new ll,this.P=r&&r.fastHandshake||!1,this.O=r&&r.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=r&&r.Rb||!1,r&&r.xa&&this.j.xa(),r&&r.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&r&&r.detectBufferingProxy||!1,this.ja=void 0,r&&r.longPollingTimeout&&0<r.longPollingTimeout&&(this.ja=r.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ws.prototype,n.la=8,n.G=1,n.connect=function(r,a,u,h){zt(0),this.W=r,this.H=a||{},u&&h!==void 0&&(this.H.OSID=u,this.H.OAID=h),this.F=this.X,this.I=xs(this,null,this.W),er(this)};function Xr(r){if(As(r),r.G==3){var a=r.U++,u=he(r.I);if(st(u,"SID",r.K),st(u,"RID",a),st(u,"TYPE","terminate"),En(r,u),a=new ge(r,r.j,a),a.L=2,a.v=Yn(he(u)),u=!1,c.navigator&&c.navigator.sendBeacon)try{u=c.navigator.sendBeacon(a.v.toString(),"")}catch{}!u&&c.Image&&(new Image().src=a.v,u=!0),u||(a.g=Ns(a.j,null),a.g.ea(a.v)),a.F=Date.now(),Qn(a)}Ds(r)}function tr(r){r.g&&(Jr(r),r.g.cancel(),r.g=null)}function As(r){tr(r),r.u&&(c.clearTimeout(r.u),r.u=null),nr(r),r.h.cancel(),r.s&&(typeof r.s=="number"&&c.clearTimeout(r.s),r.s=null)}function er(r){if(!ss(r.h)&&!r.s){r.s=!0;var a=r.Ga;rt||Ht(),at||(rt(),at=!0),ee.add(a,r),r.B=0}}function dl(r,a){return os(r.h)>=r.h.j-(r.s?1:0)?!1:r.s?(r.i=a.D.concat(r.i),!0):r.G==1||r.G==2||r.B>=(r.Va?0:r.Wa)?!1:(r.s=cn(w(r.Ga,r,a),Vs(r,r.B)),r.B++,!0)}n.Ga=function(r){if(this.s)if(this.s=null,this.G==1){if(!r){this.U=Math.floor(1e5*Math.random()),r=this.U++;const I=new ge(this,this.j,r);let A=this.o;if(this.S&&(A?(A=d(A),_(A,this.S)):A=this.S),this.m!==null||this.O||(I.H=A,A=null),this.P)t:{for(var a=0,u=0;u<this.i.length;u++){e:{var h=this.i[u];if("__data__"in h.map&&(h=h.map.__data__,typeof h=="string")){h=h.length;break e}h=void 0}if(h===void 0)break;if(a+=h,4096<a){a=u;break t}if(a===4096||u===this.i.length-1){a=u+1;break t}}a=1e3}else a=1e3;a=Ps(this,I,a),u=he(this.I),st(u,"RID",r),st(u,"CVER",22),this.D&&st(u,"X-HTTP-Session-Id",this.D),En(this,u),A&&(this.O?a="headers="+encodeURIComponent(String(_s(A)))+"&"+a:this.m&&Wr(u,this.m,A)),Qr(this.h,I),this.Ua&&st(u,"TYPE","init"),this.P?(st(u,"$req",a),st(u,"SID","null"),I.T=!0,Hr(I,u,null)):Hr(I,u,a),this.G=2}}else this.G==3&&(r?Rs(this,r):this.i.length==0||ss(this.h)||Rs(this))};function Rs(r,a){var u;a?u=a.l:u=r.U++;const h=he(r.I);st(h,"SID",r.K),st(h,"RID",u),st(h,"AID",r.T),En(r,h),r.m&&r.o&&Wr(h,r.m,r.o),u=new ge(r,r.j,u,r.B+1),r.m===null&&(u.H=r.o),a&&(r.i=a.D.concat(r.i)),a=Ps(r,u,1e3),u.I=Math.round(.5*r.wa)+Math.round(.5*r.wa*Math.random()),Qr(r.h,u),Hr(u,h,a)}function En(r,a){r.H&&G(r.H,function(u,h){st(a,h,u)}),r.l&&us({},function(u,h){st(a,h,u)})}function Ps(r,a,u){u=Math.min(r.i.length,u);var h=r.l?w(r.l.Na,r.l,r):null;t:{var I=r.i;let A=-1;for(;;){const b=["count="+u];A==-1?0<u?(A=I[0].g,b.push("ofs="+A)):A=0:b.push("ofs="+A);let nt=!0;for(let St=0;St<u;St++){let J=I[St].g;const kt=I[St].map;if(J-=A,0>J)A=Math.max(0,I[St].g-100),nt=!1;else try{ul(kt,b,"req"+J+"_")}catch{h&&h(kt)}}if(nt){h=b.join("&");break t}}}return r=r.i.splice(0,u),a.D=r,h}function Cs(r){if(!r.g&&!r.u){r.Y=1;var a=r.Fa;rt||Ht(),at||(rt(),at=!0),ee.add(a,r),r.v=0}}function Yr(r){return r.g||r.u||3<=r.v?!1:(r.Y++,r.u=cn(w(r.Fa,r),Vs(r,r.v)),r.v++,!0)}n.Fa=function(){if(this.u=null,Ss(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var r=2*this.R;this.j.info("BP detection timer enabled: "+r),this.A=cn(w(this.ab,this),r)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,zt(10),tr(this),Ss(this))};function Jr(r){r.A!=null&&(c.clearTimeout(r.A),r.A=null)}function Ss(r){r.g=new ge(r,r.j,"rpc",r.Y),r.m===null&&(r.g.H=r.o),r.g.O=0;var a=he(r.qa);st(a,"RID","rpc"),st(a,"SID",r.K),st(a,"AID",r.T),st(a,"CI",r.F?"0":"1"),!r.F&&r.ja&&st(a,"TO",r.ja),st(a,"TYPE","xmlhttp"),En(r,a),r.m&&r.o&&Wr(a,r.m,r.o),r.L&&(r.g.I=r.L);var u=r.g;r=r.ia,u.L=1,u.v=Yn(he(a)),u.m=null,u.P=!0,es(u,r)}n.Za=function(){this.C!=null&&(this.C=null,tr(this),Yr(this),zt(19))};function nr(r){r.C!=null&&(c.clearTimeout(r.C),r.C=null)}function bs(r,a){var u=null;if(r.g==a){nr(r),Jr(r),r.g=null;var h=2}else if(Kr(r.h,a))u=a.D,as(r.h,a),h=1;else return;if(r.G!=0){if(a.o)if(h==1){u=a.m?a.m.length:0,a=Date.now()-a.F;var I=r.B;h=qn(),jt(h,new Yi(h,u)),er(r)}else Cs(r);else if(I=a.s,I==3||I==0&&0<a.X||!(h==1&&dl(r,a)||h==2&&Yr(r)))switch(u&&0<u.length&&(a=r.h,a.i=a.i.concat(u)),I){case 1:be(r,5);break;case 4:be(r,10);break;case 3:be(r,6);break;default:be(r,2)}}}function Vs(r,a){let u=r.Ta+Math.floor(Math.random()*r.cb);return r.isActive()||(u*=2),u*a}function be(r,a){if(r.j.info("Error code "+a),a==2){var u=w(r.fb,r),h=r.Xa;const I=!h;h=new Se(h||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Wn(h,"https"),Yn(h),I?ol(h.toString(),u):al(h.toString(),u)}else zt(2);r.G=0,r.l&&r.l.sa(a),Ds(r),As(r)}n.fb=function(r){r?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function Ds(r){if(r.G=0,r.ka=[],r.l){const a=ls(r.h);(a.length!=0||r.i.length!=0)&&(x(r.ka,a),x(r.ka,r.i),r.h.i.length=0,N(r.i),r.i.length=0),r.l.ra()}}function xs(r,a,u){var h=u instanceof Se?he(u):new Se(u);if(h.g!="")a&&(h.g=a+"."+h.g),Xn(h,h.s);else{var I=c.location;h=I.protocol,a=a?a+"."+I.hostname:I.hostname,I=+I.port;var A=new Se(null);h&&Wn(A,h),a&&(A.g=a),I&&Xn(A,I),u&&(A.l=u),h=A}return u=r.D,a=r.ya,u&&a&&st(h,u,a),st(h,"VER",r.la),En(r,h),h}function Ns(r,a,u){if(a&&!r.J)throw Error("Can't create secondary domain capable XhrIo object.");return a=r.Ca&&!r.pa?new ct(new gn({eb:u})):new ct(r.pa),a.Ha(r.J),a}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ks(){}n=ks.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function rr(){}rr.prototype.g=function(r,a){return new te(r,a)};function te(r,a){Nt.call(this),this.g=new ws(a),this.l=r,this.h=a&&a.messageUrlParams||null,r=a&&a.messageHeaders||null,a&&a.clientProtocolHeaderRequired&&(r?r["X-Client-Protocol"]="webchannel":r={"X-Client-Protocol":"webchannel"}),this.g.o=r,r=a&&a.initMessageHeaders||null,a&&a.messageContentType&&(r?r["X-WebChannel-Content-Type"]=a.messageContentType:r={"X-WebChannel-Content-Type":a.messageContentType}),a&&a.va&&(r?r["X-WebChannel-Client-Profile"]=a.va:r={"X-WebChannel-Client-Profile":a.va}),this.g.S=r,(r=a&&a.Sb)&&!O(r)&&(this.g.m=r),this.v=a&&a.supportsCrossDomainXhr||!1,this.u=a&&a.sendRawJson||!1,(a=a&&a.httpSessionIdParam)&&!O(a)&&(this.g.D=a,r=this.h,r!==null&&a in r&&(r=this.h,a in r&&delete r[a])),this.j=new qe(this)}D(te,Nt),te.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},te.prototype.close=function(){Xr(this.g)},te.prototype.o=function(r){var a=this.g;if(typeof r=="string"){var u={};u.__data__=r,r=u}else this.u&&(u={},u.__data__=Fr(r),r=u);a.i.push(new Xa(a.Ya++,r)),a.G==3&&er(a)},te.prototype.N=function(){this.g.l=null,delete this.j,Xr(this.g),delete this.g,te.aa.N.call(this)};function Ms(r){Ur.call(this),r.__headers__&&(this.headers=r.__headers__,this.statusCode=r.__status__,delete r.__headers__,delete r.__status__);var a=r.__sm__;if(a){t:{for(const u in a){r=u;break t}r=void 0}(this.i=r)&&(r=this.i,a=a!==null&&r in a?a[r]:void 0),this.data=a}else this.data=r}D(Ms,Ur);function Os(){Br.call(this),this.status=1}D(Os,Br);function qe(r){this.g=r}D(qe,ks),qe.prototype.ua=function(){jt(this.g,"a")},qe.prototype.ta=function(r){jt(this.g,new Ms(r))},qe.prototype.sa=function(r){jt(this.g,new Os)},qe.prototype.ra=function(){jt(this.g,"b")},rr.prototype.createWebChannel=rr.prototype.g,te.prototype.send=te.prototype.o,te.prototype.open=te.prototype.m,te.prototype.close=te.prototype.close,Ho=function(){return new rr},zo=function(){return qn()},jo=Pe,pi={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gn.NO_ERROR=0,Gn.TIMEOUT=8,Gn.HTTP_ERROR=6,cr=Gn,Ji.COMPLETE="complete",Bo=Ji,Ki.EventType=ln,ln.OPEN="a",ln.CLOSE="b",ln.ERROR="c",ln.MESSAGE="d",Nt.prototype.listen=Nt.prototype.K,Pn=Ki,Uo=gn,ct.prototype.listenOnce=ct.prototype.L,ct.prototype.getLastError=ct.prototype.Ka,ct.prototype.getLastErrorCode=ct.prototype.Ba,ct.prototype.getStatus=ct.prototype.Z,ct.prototype.getResponseJson=ct.prototype.Oa,ct.prototype.getResponseText=ct.prototype.oa,ct.prototype.send=ct.prototype.ea,ct.prototype.setWithCredentials=ct.prototype.Ha,$o=ct}).apply(typeof sr<"u"?sr:typeof self<"u"?self:typeof window<"u"?window:{});const Zs="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Lt.UNAUTHENTICATED=new Lt(null),Lt.GOOGLE_CREDENTIALS=new Lt("google-credentials-uid"),Lt.FIRST_PARTY=new Lt("first-party-uid"),Lt.MOCK_USER=new Lt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sn="10.12.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me=new xo("@firebase/firestore");function An(){return Me.logLevel}function M(n,...t){if(Me.logLevel<=Y.DEBUG){const e=t.map(Ri);Me.debug(`Firestore (${sn}): ${n}`,...e)}}function Oe(n,...t){if(Me.logLevel<=Y.ERROR){const e=t.map(Ri);Me.error(`Firestore (${sn}): ${n}`,...e)}}function gr(n,...t){if(Me.logLevel<=Y.WARN){const e=t.map(Ri);Me.warn(`Firestore (${sn}): ${n}`,...e)}}function Ri(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(e){return JSON.stringify(e)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(n="Unexpected state"){const t=`FIRESTORE (${sn}) INTERNAL ASSERTION FAILED: `+n;throw Oe(t),new Error(t)}function Ct(n,t){n||K()}function ot(n,t){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $ extends rn{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class ac{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(Lt.UNAUTHENTICATED))}shutdown(){}}class lc{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class uc{constructor(t){this.t=t,this.currentUser=Lt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let i=this.i;const s=f=>this.i!==i?(i=this.i,e(f)):Promise.resolve();let o=new xe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new xe,t.enqueueRetryable(()=>s(this.currentUser))};const l=()=>{const f=o;t.enqueueRetryable(async()=>{await f.promise,await s(this.currentUser)})},c=f=>{M("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.auth.addAuthTokenListener(this.o),l()};this.t.onInit(f=>c(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?c(f):(M("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new xe)}},0),l()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(i=>this.i!==t?(M("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ct(typeof i.accessToken=="string"),new qo(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Ct(t===null||typeof t=="string"),new Lt(t)}}class cc{constructor(t,e,i){this.l=t,this.h=e,this.P=i,this.type="FirstParty",this.user=Lt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class hc{constructor(t,e,i){this.l=t,this.h=e,this.P=i}getToken(){return Promise.resolve(new cc(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(Lt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fc{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dc{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const i=o=>{o.error!=null&&M("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.R;return this.R=o.token,M("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?e(o.token):Promise.resolve()};this.o=o=>{t.enqueueRetryable(()=>i(o))};const s=o=>{M("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?s(o):M("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(Ct(typeof e.token=="string"),this.R=e.token,new fc(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pc(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let i="";for(;i.length<20;){const s=pc(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<e&&(i+=t.charAt(s[o]%t.length))}return i}}function it(n,t){return n<t?-1:n>t?1:0}function Je(n,t,e){return n.length===t.length&&n.every((i,s)=>e(i,t[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new $(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new $(C.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new $(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new $(C.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Pt.fromMillis(Date.now())}static fromDate(t){return Pt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*e));return new Pt(e,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?it(this.nanoseconds,t.nanoseconds):it(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(t){this.timestamp=t}static fromTimestamp(t){return new lt(t)}static min(){return new lt(new Pt(0,0))}static max(){return new lt(new Pt(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(t,e,i){e===void 0?e=0:e>t.length&&K(),i===void 0?i=t.length-e:i>t.length-e&&K(),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return kn.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof kn?t.forEach(i=>{e.push(i)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let s=0;s<i;s++){const o=t.get(s),l=e.get(s);if(o<l)return-1;if(o>l)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class yt extends kn{construct(t,e,i){return new yt(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new $(C.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(s=>s.length>0))}return new yt(e)}static emptyPath(){return new yt([])}}const mc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dt extends kn{construct(t,e,i){return new Dt(t,e,i)}static isValidIdentifier(t){return mc.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dt.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Dt(["__name__"])}static fromServerFormat(t){const e=[];let i="",s=0;const o=()=>{if(i.length===0)throw new $(C.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let l=!1;for(;s<t.length;){const c=t[s];if(c==="\\"){if(s+1===t.length)throw new $(C.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const f=t[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new $(C.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=f,s+=2}else c==="`"?(l=!l,s++):c!=="."||l?(i+=c,s++):(o(),s++)}if(o(),l)throw new $(C.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Dt(e)}static emptyPath(){return new Dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(t){this.path=t}static fromPath(t){return new H(yt.fromString(t))}static fromName(t){return new H(yt.fromString(t).popFirst(5))}static empty(){return new H(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&yt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return yt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new H(new yt(t.slice()))}}function gc(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=lt.fromTimestamp(i===1e9?new Pt(e+1,0):new Pt(e,i));return new Ie(s,H.empty(),t)}function _c(n){return new Ie(n.readTime,n.key,-1)}class Ie{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new Ie(lt.min(),H.empty(),-1)}static max(){return new Ie(lt.max(),H.empty(),-1)}}function yc(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=H.comparator(n.documentKey,t.documentKey),e!==0?e:it(n.largestBatchId,t.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ec{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ko(n){if(n.code!==C.FAILED_PRECONDITION||n.message!==vc)throw n;M("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&K(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new P((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(t,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(e,o).next(i,s)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof P?e:P.resolve(e)}catch(e){return P.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):P.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):P.reject(e)}static resolve(t){return new P((e,i)=>{e(t)})}static reject(t){return new P((e,i)=>{i(t)})}static waitFor(t){return new P((e,i)=>{let s=0,o=0,l=!1;t.forEach(c=>{++s,c.next(()=>{++o,l&&o===s&&e()},f=>i(f))}),l=!0,o===s&&e()})}static or(t){let e=P.resolve(!1);for(const i of t)e=e.next(s=>s?P.resolve(s):i());return e}static forEach(t,e){const i=[];return t.forEach((s,o)=>{i.push(e.call(this,s,o))}),this.waitFor(i)}static mapArray(t,e){return new P((i,s)=>{const o=t.length,l=new Array(o);let c=0;for(let f=0;f<o;f++){const p=f;e(t[p]).next(E=>{l[p]=E,++c,c===o&&i(l)},E=>s(E))}})}static doWhile(t,e){return new P((i,s)=>{const o=()=>{t()===!0?e().next(()=>{o()},s):i()};o()})}}function Tc(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Pr(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.ie(i),this.se=i=>e.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}Qo.oe=-1;function Pi(n){return n==null}function _r(n){return n===0&&1/n==-1/0}function Ic(n){return typeof n=="number"&&Number.isInteger(n)&&!_r(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Un(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function Wo(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(t,e){this.comparator=t,this.root=e||bt.EMPTY}insert(t,e){return new Kt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(t){return new Kt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,bt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return e+i.left.size;s<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,i)=>(t(e,i),!1))}toString(){const t=[];return this.inorderTraversal((e,i)=>(t.push(`${e}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new or(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new or(this.root,t,this.comparator,!1)}getReverseIterator(){return new or(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new or(this.root,t,this.comparator,!0)}}class or{constructor(t,e,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!t.isEmpty();)if(o=e?i(t.key,e):1,e&&s&&(o*=-1),o<0)t=this.isReverse?t.left:t.right;else{if(o===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class bt{constructor(t,e,i,s,o){this.key=t,this.value=e,this.color=i??bt.RED,this.left=s??bt.EMPTY,this.right=o??bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,s,o){return new bt(t??this.key,e??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let s=this;const o=i(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,e,i),null):o===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return bt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw K();const t=this.left.check();if(t!==this.right.check())throw K();return t+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw K()}get value(){throw K()}get color(){throw K()}get left(){throw K()}get right(){throw K()}copy(t,e,i,s,o){return this}insert(t,e,i){return new bt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(t){this.comparator=t,this.data=new Kt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,i)=>(t(e),!1))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new eo(this.data.getIterator())}getIteratorFrom(t){return new eo(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(i=>{e=e.add(i)}),e}isEqual(t){if(!(t instanceof $t)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new $t(this.comparator);return e.data=t,e}}class eo{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oe{constructor(t){this.fields=t,t.sort(Dt.comparator)}static empty(){return new oe([])}unionWith(t){let e=new $t(Dt.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new oe(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Je(this.fields,t.fields,(e,i)=>e.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new wc("Invalid base64 string: "+o):o}}(t);return new pe(e)}static fromUint8Array(t){const e=function(s){let o="";for(let l=0;l<s.length;++l)o+=String.fromCharCode(s[l]);return o}(t);return new pe(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const i=new Uint8Array(e.length);for(let s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return it(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}pe.EMPTY_BYTE_STRING=new pe("");const Ac=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Le(n){if(Ct(!!n),typeof n=="string"){let t=0;const e=Ac.exec(n);if(Ct(!!e),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Vt(n.seconds),nanos:Vt(n.nanos)}}function Vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Mn(n){return typeof n=="string"?pe.fromBase64String(n):pe.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(n){var t,e;return((e=(((t=n==null?void 0:n.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="server_timestamp"}function Xo(n){const t=n.mapValue.fields.__previous_value__;return Ci(t)?Xo(t):t}function yr(n){const t=Le(n.mapValue.fields.__local_write_time__.timestampValue);return new Pt(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(t,e,i,s,o,l,c,f,p){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=c,this.longPollingOptions=f,this.useFetchStreams=p}}class vr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new vr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof vr&&t.projectId===this.projectId&&t.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ze(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ci(n)?4:Pc(n)?9007199254740991:10:K()}function ce(n,t){if(n===t)return!0;const e=Ze(n);if(e!==Ze(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return yr(n).isEqual(yr(t));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const l=Le(s.timestampValue),c=Le(o.timestampValue);return l.seconds===c.seconds&&l.nanos===c.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(s,o){return Mn(s.bytesValue).isEqual(Mn(o.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(s,o){return Vt(s.geoPointValue.latitude)===Vt(o.geoPointValue.latitude)&&Vt(s.geoPointValue.longitude)===Vt(o.geoPointValue.longitude)}(n,t);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return Vt(s.integerValue)===Vt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const l=Vt(s.doubleValue),c=Vt(o.doubleValue);return l===c?_r(l)===_r(c):isNaN(l)&&isNaN(c)}return!1}(n,t);case 9:return Je(n.arrayValue.values||[],t.arrayValue.values||[],ce);case 10:return function(s,o){const l=s.mapValue.fields||{},c=o.mapValue.fields||{};if(to(l)!==to(c))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(c[f]===void 0||!ce(l[f],c[f])))return!1;return!0}(n,t);default:return K()}}function On(n,t){return(n.values||[]).find(e=>ce(e,t))!==void 0}function tn(n,t){if(n===t)return 0;const e=Ze(n),i=Ze(t);if(e!==i)return it(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return it(n.booleanValue,t.booleanValue);case 2:return function(o,l){const c=Vt(o.integerValue||o.doubleValue),f=Vt(l.integerValue||l.doubleValue);return c<f?-1:c>f?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1}(n,t);case 3:return no(n.timestampValue,t.timestampValue);case 4:return no(yr(n),yr(t));case 5:return it(n.stringValue,t.stringValue);case 6:return function(o,l){const c=Mn(o),f=Mn(l);return c.compareTo(f)}(n.bytesValue,t.bytesValue);case 7:return function(o,l){const c=o.split("/"),f=l.split("/");for(let p=0;p<c.length&&p<f.length;p++){const E=it(c[p],f[p]);if(E!==0)return E}return it(c.length,f.length)}(n.referenceValue,t.referenceValue);case 8:return function(o,l){const c=it(Vt(o.latitude),Vt(l.latitude));return c!==0?c:it(Vt(o.longitude),Vt(l.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return function(o,l){const c=o.values||[],f=l.values||[];for(let p=0;p<c.length&&p<f.length;++p){const E=tn(c[p],f[p]);if(E)return E}return it(c.length,f.length)}(n.arrayValue,t.arrayValue);case 10:return function(o,l){if(o===ar.mapValue&&l===ar.mapValue)return 0;if(o===ar.mapValue)return 1;if(l===ar.mapValue)return-1;const c=o.fields||{},f=Object.keys(c),p=l.fields||{},E=Object.keys(p);f.sort(),E.sort();for(let R=0;R<f.length&&R<E.length;++R){const w=it(f[R],E[R]);if(w!==0)return w;const S=tn(c[f[R]],p[E[R]]);if(S!==0)return S}return it(f.length,E.length)}(n.mapValue,t.mapValue);default:throw K()}}function no(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return it(n,t);const e=Le(n),i=Le(t),s=it(e.seconds,i.seconds);return s!==0?s:it(e.nanos,i.nanos)}function en(n){return mi(n)}function mi(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){const i=Le(e);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return Mn(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return H.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let i="[",s=!0;for(const o of e.values||[])s?s=!1:i+=",",i+=mi(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(e){const i=Object.keys(e.fields||{}).sort();let s="{",o=!0;for(const l of i)o?o=!1:s+=",",s+=`${l}:${mi(e.fields[l])}`;return s+"}"}(n.mapValue):K()}function gi(n){return!!n&&"integerValue"in n}function Si(n){return!!n&&"arrayValue"in n}function hr(n){return!!n&&"mapValue"in n}function Cn(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return Un(n.mapValue.fields,(e,i)=>t.mapValue.fields[e]=Cn(i)),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Cn(n.arrayValue.values[e]);return t}return Object.assign({},n)}function Pc(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(t){this.value=t}static empty(){return new se({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!hr(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Cn(e)}setAll(t){let e=Dt.emptyPath(),i={},s=[];t.forEach((l,c)=>{if(!e.isImmediateParentOf(c)){const f=this.getFieldsMap(e);this.applyChanges(f,i,s),i={},s=[],e=c.popLast()}l?i[c.lastSegment()]=Cn(l):s.push(c.lastSegment())});const o=this.getFieldsMap(e);this.applyChanges(o,i,s)}delete(t){const e=this.field(t.popLast());hr(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return ce(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=e.mapValue.fields[t.get(i)];hr(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,i){Un(e,(s,o)=>t[s]=o);for(const s of i)delete t[s]}clone(){return new se(Cn(this.value))}}function Yo(n){const t=[];return Un(n.fields,(e,i)=>{const s=new Dt([e]);if(hr(i)){const o=Yo(i.mapValue).fields;if(o.length===0)t.push(s);else for(const l of o)t.push(s.child(l))}else t.push(s)}),new oe(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(t,e,i,s,o,l,c){this.key=t,this.documentType=e,this.version=i,this.readTime=s,this.createTime=o,this.data=l,this.documentState=c}static newInvalidDocument(t){return new re(t,0,lt.min(),lt.min(),lt.min(),se.empty(),0)}static newFoundDocument(t,e,i,s){return new re(t,1,e,lt.min(),i,s,0)}static newNoDocument(t,e){return new re(t,2,e,lt.min(),lt.min(),se.empty(),0)}static newUnknownDocument(t,e){return new re(t,3,e,lt.min(),lt.min(),se.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=se.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=se.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof re&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new re(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(t,e){this.position=t,this.inclusive=e}}function ro(n,t,e){let i=0;for(let s=0;s<n.position.length;s++){const o=t[s],l=n.position[s];if(o.field.isKeyField()?i=H.comparator(H.fromName(l.referenceValue),e.key):i=tn(l,e.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function io(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!ce(n.position[e],t.position[e]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(t,e="asc"){this.field=t,this.dir=e}}function Cc(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{}class Rt extends Jo{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new bc(t,e,i):e==="array-contains"?new xc(t,i):e==="in"?new Nc(t,i):e==="not-in"?new kc(t,i):e==="array-contains-any"?new Mc(t,i):new Rt(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new Vc(t,i):new Dc(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&this.matchesComparison(tn(e,this.value)):e!==null&&Ze(this.value)===Ze(e)&&this.matchesComparison(tn(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return K()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class we extends Jo{constructor(t,e){super(),this.filters=t,this.op=e,this.ae=null}static create(t,e){return new we(t,e)}matches(t){return Zo(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Zo(n){return n.op==="and"}function ta(n){return Sc(n)&&Zo(n)}function Sc(n){for(const t of n.filters)if(t instanceof we)return!1;return!0}function _i(n){if(n instanceof Rt)return n.field.canonicalString()+n.op.toString()+en(n.value);if(ta(n))return n.filters.map(t=>_i(t)).join(",");{const t=n.filters.map(e=>_i(e)).join(",");return`${n.op}(${t})`}}function ea(n,t){return n instanceof Rt?function(i,s){return s instanceof Rt&&i.op===s.op&&i.field.isEqual(s.field)&&ce(i.value,s.value)}(n,t):n instanceof we?function(i,s){return s instanceof we&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((o,l,c)=>o&&ea(l,s.filters[c]),!0):!1}(n,t):void K()}function na(n){return n instanceof Rt?function(e){return`${e.field.canonicalString()} ${e.op} ${en(e.value)}`}(n):n instanceof we?function(e){return e.op.toString()+" {"+e.getFilters().map(na).join(" ,")+"}"}(n):"Filter"}class bc extends Rt{constructor(t,e,i){super(t,e,i),this.key=H.fromName(i.referenceValue)}matches(t){const e=H.comparator(t.key,this.key);return this.matchesComparison(e)}}class Vc extends Rt{constructor(t,e){super(t,"in",e),this.keys=ra("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Dc extends Rt{constructor(t,e){super(t,"not-in",e),this.keys=ra("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function ra(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(i=>H.fromName(i.referenceValue))}class xc extends Rt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Si(e)&&On(e.arrayValue,this.value)}}class Nc extends Rt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&On(this.value.arrayValue,e)}}class kc extends Rt{constructor(t,e){super(t,"not-in",e)}matches(t){if(On(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&!On(this.value.arrayValue,e)}}class Mc extends Rt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Si(e)||!e.arrayValue.values)&&e.arrayValue.values.some(i=>On(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(t,e=null,i=[],s=[],o=null,l=null,c=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=l,this.endAt=c,this.ue=null}}function so(n,t=null,e=[],i=[],s=null,o=null,l=null){return new Oc(n,t,e,i,s,o,l)}function bi(n){const t=ot(n);if(t.ue===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(i=>_i(i)).join(","),e+="|ob:",e+=t.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),Pi(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>en(i)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>en(i)).join(",")),t.ue=e}return t.ue}function Vi(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!Cc(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!ea(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!io(n.startAt,t.startAt)&&io(n.endAt,t.endAt)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(t,e=null,i=[],s=[],o=null,l="F",c=null,f=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=l,this.startAt=c,this.endAt=f,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Lc(n,t,e,i,s,o,l,c){return new Cr(n,t,e,i,s,o,l,c)}function Fc(n){return new Cr(n)}function oo(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function $c(n){return n.collectionGroup!==null}function Sn(n){const t=ot(n);if(t.ce===null){t.ce=[];const e=new Set;for(const o of t.explicitOrderBy)t.ce.push(o),e.add(o.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(l){let c=new $t(Dt.comparator);return l.filters.forEach(f=>{f.getFlattenedFilters().forEach(p=>{p.isInequality()&&(c=c.add(p.field))})}),c})(t).forEach(o=>{e.has(o.canonicalString())||o.isKeyField()||t.ce.push(new Tr(o,i))}),e.has(Dt.keyField().canonicalString())||t.ce.push(new Tr(Dt.keyField(),i))}return t.ce}function Ne(n){const t=ot(n);return t.le||(t.le=Uc(t,Sn(n))),t.le}function Uc(n,t){if(n.limitType==="F")return so(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new Tr(s.field,o)});const e=n.endAt?new Er(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Er(n.startAt.position,n.startAt.inclusive):null;return so(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function yi(n,t,e){return new Cr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function ia(n,t){return Vi(Ne(n),Ne(t))&&n.limitType===t.limitType}function sa(n){return`${bi(Ne(n))}|lt:${n.limitType}`}function Rn(n){return`Query(target=${function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(s=>na(s)).join(", ")}]`),Pi(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(s=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(s)).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(s=>en(s)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(s=>en(s)).join(",")),`Target(${i})`}(Ne(n))}; limitType=${n.limitType})`}function Di(n,t){return t.isFoundDocument()&&function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):H.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(n,t)&&function(i,s){for(const o of Sn(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(n,t)&&function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0}(n,t)&&function(i,s){return!(i.startAt&&!function(l,c,f){const p=ro(l,c,f);return l.inclusive?p<=0:p<0}(i.startAt,Sn(i),s)||i.endAt&&!function(l,c,f){const p=ro(l,c,f);return l.inclusive?p>=0:p>0}(i.endAt,Sn(i),s))}(n,t)}function Bc(n){return(t,e)=>{let i=!1;for(const s of Sn(n)){const o=jc(s,t,e);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function jc(n,t,e){const i=n.field.isKeyField()?H.comparator(t.key,e.key):function(o,l,c){const f=l.data.field(o),p=c.data.field(o);return f!==null&&p!==null?tn(f,p):K()}(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return K()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,t))return o}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],t))return void(s[o]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[e]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Un(this.inner,(e,i)=>{for(const[s,o]of i)t(s,o)})}isEmpty(){return Wo(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zc=new Kt(H.comparator);function Ir(){return zc}const oa=new Kt(H.comparator);function lr(...n){let t=oa;for(const e of n)t=t.insert(e.key,e);return t}function aa(n){let t=oa;return n.forEach((e,i)=>t=t.insert(e,i.overlayedDocument)),t}function De(){return bn()}function la(){return bn()}function bn(){return new on(n=>n.toString(),(n,t)=>n.isEqual(t))}const Hc=new Kt(H.comparator),qc=new $t(H.comparator);function Ft(...n){let t=qc;for(const e of n)t=t.add(e);return t}const Gc=new $t(it);function Kc(){return Gc}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_r(t)?"-0":t}}function ca(n){return{integerValue:""+n}}function Qc(n,t){return Ic(t)?ca(t):ua(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(){this._=void 0}}function Wc(n,t,e){return n instanceof wr?function(s,o){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Ci(o)&&(o=Xo(o)),o&&(l.fields.__previous_value__=o),{mapValue:l}}(e,t):n instanceof Ln?fa(n,t):n instanceof Fn?da(n,t):function(s,o){const l=ha(s,o),c=ao(l)+ao(s.Pe);return gi(l)&&gi(s.Pe)?ca(c):ua(s.serializer,c)}(n,t)}function Xc(n,t,e){return n instanceof Ln?fa(n,t):n instanceof Fn?da(n,t):e}function ha(n,t){return n instanceof Ar?function(i){return gi(i)||function(o){return!!o&&"doubleValue"in o}(i)}(t)?t:{integerValue:0}:null}class wr extends Sr{}class Ln extends Sr{constructor(t){super(),this.elements=t}}function fa(n,t){const e=pa(t);for(const i of n.elements)e.some(s=>ce(s,i))||e.push(i);return{arrayValue:{values:e}}}class Fn extends Sr{constructor(t){super(),this.elements=t}}function da(n,t){let e=pa(t);for(const i of n.elements)e=e.filter(s=>!ce(s,i));return{arrayValue:{values:e}}}class Ar extends Sr{constructor(t,e){super(),this.serializer=t,this.Pe=e}}function ao(n){return Vt(n.integerValue||n.doubleValue)}function pa(n){return Si(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function Yc(n,t){return n.field.isEqual(t.field)&&function(i,s){return i instanceof Ln&&s instanceof Ln||i instanceof Fn&&s instanceof Fn?Je(i.elements,s.elements,ce):i instanceof Ar&&s instanceof Ar?ce(i.Pe,s.Pe):i instanceof wr&&s instanceof wr}(n.transform,t.transform)}class Jc{constructor(t,e){this.version=t,this.transformResults=e}}class de{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new de}static exists(t){return new de(void 0,t)}static updateTime(t){return new de(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function fr(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class br{}function ma(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new _a(n.key,de.none()):new Bn(n.key,n.data,de.none());{const e=n.data,i=se.empty();let s=new $t(Dt.comparator);for(let o of t.fields)if(!s.has(o)){let l=e.field(o);l===null&&o.length>1&&(o=o.popLast(),l=e.field(o)),l===null?i.delete(o):i.set(o,l),s=s.add(o)}return new Be(n.key,i,new oe(s.toArray()),de.none())}}function Zc(n,t,e){n instanceof Bn?function(s,o,l){const c=s.value.clone(),f=uo(s.fieldTransforms,o,l.transformResults);c.setAll(f),o.convertToFoundDocument(l.version,c).setHasCommittedMutations()}(n,t,e):n instanceof Be?function(s,o,l){if(!fr(s.precondition,o))return void o.convertToUnknownDocument(l.version);const c=uo(s.fieldTransforms,o,l.transformResults),f=o.data;f.setAll(ga(s)),f.setAll(c),o.convertToFoundDocument(l.version,f).setHasCommittedMutations()}(n,t,e):function(s,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()}(0,t,e)}function Vn(n,t,e,i){return n instanceof Bn?function(o,l,c,f){if(!fr(o.precondition,l))return c;const p=o.value.clone(),E=co(o.fieldTransforms,f,l);return p.setAll(E),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null}(n,t,e,i):n instanceof Be?function(o,l,c,f){if(!fr(o.precondition,l))return c;const p=co(o.fieldTransforms,f,l),E=l.data;return E.setAll(ga(o)),E.setAll(p),l.convertToFoundDocument(l.version,E).setHasLocalMutations(),c===null?null:c.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(R=>R.field))}(n,t,e,i):function(o,l,c){return fr(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):c}(n,t,e)}function th(n,t){let e=null;for(const i of n.fieldTransforms){const s=t.data.field(i.field),o=ha(i.transform,s||null);o!=null&&(e===null&&(e=se.empty()),e.set(i.field,o))}return e||null}function lo(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&Je(i,s,(o,l)=>Yc(o,l))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Bn extends br{constructor(t,e,i,s=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Be extends br{constructor(t,e,i,s,o=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function ga(n){const t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}}),t}function uo(n,t,e){const i=new Map;Ct(n.length===e.length);for(let s=0;s<e.length;s++){const o=n[s],l=o.transform,c=t.data.field(o.field);i.set(o.field,Xc(l,c,e[s]))}return i}function co(n,t,e){const i=new Map;for(const s of n){const o=s.transform,l=e.data.field(s.field);i.set(s.field,Wc(o,l,t))}return i}class _a extends br{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eh extends br{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(t,e,i,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(t.key)&&Zc(o,t,i[s])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=Vn(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=Vn(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=la();return this.mutations.forEach(s=>{const o=t.get(s.key),l=o.overlayedDocument;let c=this.applyToLocalView(l,o.mutatedFields);c=e.has(s.key)?null:c;const f=ma(l,c);f!==null&&i.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(lt.min())}),i}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),Ft())}isEqual(t){return this.batchId===t.batchId&&Je(this.mutations,t.mutations,(e,i)=>lo(e,i))&&Je(this.baseMutations,t.baseMutations,(e,i)=>lo(e,i))}}class xi{constructor(t,e,i,s){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=s}static from(t,e,i){Ct(t.mutations.length===i.length);let s=function(){return Hc}();const o=t.mutations;for(let l=0;l<o.length;l++)s=s.insert(o[l].key,i[l].version);return new xi(t,e,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt,W;function ih(n){switch(n){default:return K();case C.CANCELLED:case C.UNKNOWN:case C.DEADLINE_EXCEEDED:case C.RESOURCE_EXHAUSTED:case C.INTERNAL:case C.UNAVAILABLE:case C.UNAUTHENTICATED:return!1;case C.INVALID_ARGUMENT:case C.NOT_FOUND:case C.ALREADY_EXISTS:case C.PERMISSION_DENIED:case C.FAILED_PRECONDITION:case C.ABORTED:case C.OUT_OF_RANGE:case C.UNIMPLEMENTED:case C.DATA_LOSS:return!0}}function sh(n){if(n===void 0)return Oe("GRPC error has no .code"),C.UNKNOWN;switch(n){case Tt.OK:return C.OK;case Tt.CANCELLED:return C.CANCELLED;case Tt.UNKNOWN:return C.UNKNOWN;case Tt.DEADLINE_EXCEEDED:return C.DEADLINE_EXCEEDED;case Tt.RESOURCE_EXHAUSTED:return C.RESOURCE_EXHAUSTED;case Tt.INTERNAL:return C.INTERNAL;case Tt.UNAVAILABLE:return C.UNAVAILABLE;case Tt.UNAUTHENTICATED:return C.UNAUTHENTICATED;case Tt.INVALID_ARGUMENT:return C.INVALID_ARGUMENT;case Tt.NOT_FOUND:return C.NOT_FOUND;case Tt.ALREADY_EXISTS:return C.ALREADY_EXISTS;case Tt.PERMISSION_DENIED:return C.PERMISSION_DENIED;case Tt.FAILED_PRECONDITION:return C.FAILED_PRECONDITION;case Tt.ABORTED:return C.ABORTED;case Tt.OUT_OF_RANGE:return C.OUT_OF_RANGE;case Tt.UNIMPLEMENTED:return C.UNIMPLEMENTED;case Tt.DATA_LOSS:return C.DATA_LOSS;default:return K()}}(W=Tt||(Tt={}))[W.OK=0]="OK",W[W.CANCELLED=1]="CANCELLED",W[W.UNKNOWN=2]="UNKNOWN",W[W.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",W[W.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",W[W.NOT_FOUND=5]="NOT_FOUND",W[W.ALREADY_EXISTS=6]="ALREADY_EXISTS",W[W.PERMISSION_DENIED=7]="PERMISSION_DENIED",W[W.UNAUTHENTICATED=16]="UNAUTHENTICATED",W[W.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",W[W.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",W[W.ABORTED=10]="ABORTED",W[W.OUT_OF_RANGE=11]="OUT_OF_RANGE",W[W.UNIMPLEMENTED=12]="UNIMPLEMENTED",W[W.INTERNAL=13]="INTERNAL",W[W.UNAVAILABLE=14]="UNAVAILABLE",W[W.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Fo([4294967295,4294967295],0);class oh{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function vi(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function ah(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function lh(n,t){return vi(n,t.toTimestamp())}function Xe(n){return Ct(!!n),lt.fromTimestamp(function(e){const i=Le(e);return new Pt(i.seconds,i.nanos)}(n))}function ya(n,t){return Ei(n,t).canonicalString()}function Ei(n,t){const e=function(s){return new yt(["projects",s.projectId,"databases",s.database])}(n).child("documents");return t===void 0?e:e.child(t)}function uh(n){const t=yt.fromString(n);return Ct(_h(t)),t}function Ti(n,t){return ya(n.databaseId,t.path)}function ch(n){const t=uh(n);return t.length===4?yt.emptyPath():fh(t)}function hh(n){return new yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function fh(n){return Ct(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function ho(n,t,e){return{name:Ti(n,t),fields:e.value.mapValue.fields}}function dh(n,t){let e;if(t instanceof Bn)e={update:ho(n,t.key,t.value)};else if(t instanceof _a)e={delete:Ti(n,t.key)};else if(t instanceof Be)e={update:ho(n,t.key,t.data),updateMask:gh(t.fieldMask)};else{if(!(t instanceof eh))return K();e={verify:Ti(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(i=>function(o,l){const c=l.transform;if(c instanceof wr)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ln)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Fn)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ar)return{fieldPath:l.field.canonicalString(),increment:c.Pe};throw K()}(0,i))),t.precondition.isNone||(e.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:lh(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:K()}(n,t.precondition)),e}function ph(n,t){return n&&n.length>0?(Ct(t!==void 0),n.map(e=>function(s,o){let l=s.updateTime?Xe(s.updateTime):Xe(o);return l.isEqual(lt.min())&&(l=Xe(o)),new Jc(l,s.transformResults||[])}(e,t))):[]}function mh(n){let t=ch(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let s=null;if(i>0){Ct(i===1);const E=e.from[0];E.allDescendants?s=E.collectionId:t=t.child(E.collectionId)}let o=[];e.where&&(o=function(R){const w=va(R);return w instanceof we&&ta(w)?w.getFilters():[w]}(e.where));let l=[];e.orderBy&&(l=function(R){return R.map(w=>function(D){return new Tr(Ke(D.field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(D.direction))}(w))}(e.orderBy));let c=null;e.limit&&(c=function(R){let w;return w=typeof R=="object"?R.value:R,Pi(w)?null:w}(e.limit));let f=null;e.startAt&&(f=function(R){const w=!!R.before,S=R.values||[];return new Er(S,w)}(e.startAt));let p=null;return e.endAt&&(p=function(R){const w=!R.before,S=R.values||[];return new Er(S,w)}(e.endAt)),Lc(t,s,l,o,c,"F",f,p)}function va(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=Ke(e.unaryFilter.field);return Rt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Ke(e.unaryFilter.field);return Rt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Ke(e.unaryFilter.field);return Rt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Ke(e.unaryFilter.field);return Rt.create(l,"!=",{nullValue:"NULL_VALUE"});default:return K()}}(n):n.fieldFilter!==void 0?function(e){return Rt.create(Ke(e.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return K()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return we.create(e.compositeFilter.filters.map(i=>va(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return K()}}(e.compositeFilter.op))}(n):K()}function Ke(n){return Dt.fromServerFormat(n.fieldPath)}function gh(n){const t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function _h(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(t){this.ct=t}}function vh(n){const t=mh({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?yi(t,t.limit,"L"):t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(){this._n=new Th}addToCollectionParentIndex(t,e){return this._n.add(e),P.resolve()}getCollectionParents(t,e){return P.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return P.resolve()}deleteFieldIndex(t,e){return P.resolve()}deleteAllFieldIndexes(t){return P.resolve()}createTargetIndexes(t,e){return P.resolve()}getDocumentsMatchingTarget(t,e){return P.resolve(null)}getIndexType(t,e){return P.resolve(0)}getFieldIndexes(t,e){return P.resolve([])}getNextCollectionGroupToUpdate(t){return P.resolve(null)}getMinOffset(t,e){return P.resolve(Ie.min())}getMinOffsetFromCollectionGroup(t,e){return P.resolve(Ie.min())}updateCollectionGroup(t,e,i){return P.resolve()}updateIndexEntries(t,e){return P.resolve()}}class Th{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e]||new $t(yt.comparator),o=!s.has(i);return this.index[e]=s.add(i),o}has(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e];return s&&s.has(i)}getEntries(t){return(this.index[t]||new $t(yt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new nn(0)}static Ln(){return new nn(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(){this.changes=new on(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,re.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?P.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(t,e,i,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next(s=>(i=s,this.remoteDocumentCache.getEntry(t,e))).next(s=>(i!==null&&Vn(i.mutation,s,oe.empty(),Pt.now()),s))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.getLocalViewOfDocuments(t,i,Ft()).next(()=>i))}getLocalViewOfDocuments(t,e,i=Ft()){const s=De();return this.populateOverlays(t,s,e).next(()=>this.computeViews(t,e,s,i).next(o=>{let l=lr();return o.forEach((c,f)=>{l=l.insert(c,f.overlayedDocument)}),l}))}getOverlayedDocuments(t,e){const i=De();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,Ft()))}populateOverlays(t,e,i){const s=[];return i.forEach(o=>{e.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(t,s).next(o=>{o.forEach((l,c)=>{e.set(l,c)})})}computeViews(t,e,i,s){let o=Ir();const l=bn(),c=function(){return bn()}();return e.forEach((f,p)=>{const E=i.get(p.key);s.has(p.key)&&(E===void 0||E.mutation instanceof Be)?o=o.insert(p.key,p):E!==void 0?(l.set(p.key,E.mutation.getFieldMask()),Vn(E.mutation,p,E.mutation.getFieldMask(),Pt.now())):l.set(p.key,oe.empty())}),this.recalculateAndSaveOverlays(t,o).next(f=>(f.forEach((p,E)=>l.set(p,E)),e.forEach((p,E)=>{var R;return c.set(p,new wh(E,(R=l.get(p))!==null&&R!==void 0?R:null))}),c))}recalculateAndSaveOverlays(t,e){const i=bn();let s=new Kt((l,c)=>l-c),o=Ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(l=>{for(const c of l)c.keys().forEach(f=>{const p=e.get(f);if(p===null)return;let E=i.get(f)||oe.empty();E=c.applyToLocalView(p,E),i.set(f,E);const R=(s.get(c.batchId)||Ft()).add(f);s=s.insert(c.batchId,R)})}).next(()=>{const l=[],c=s.getReverseIterator();for(;c.hasNext();){const f=c.getNext(),p=f.key,E=f.value,R=la();E.forEach(w=>{if(!o.has(w)){const S=ma(e.get(w),i.get(w));S!==null&&R.set(w,S),o=o.add(w)}}),l.push(this.documentOverlayCache.saveOverlays(t,p,R))}return P.waitFor(l)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,e,i,s){return function(l){return H.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):$c(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,s):this.getDocumentsMatchingCollectionQuery(t,e,i,s)}getNextDocuments(t,e,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,s).next(o=>{const l=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,s-o.size):P.resolve(De());let c=-1,f=o;return l.next(p=>P.forEach(p,(E,R)=>(c<R.largestBatchId&&(c=R.largestBatchId),o.get(E)?P.resolve():this.remoteDocumentCache.getEntry(t,E).next(w=>{f=f.insert(E,w)}))).next(()=>this.populateOverlays(t,p,o)).next(()=>this.computeViews(t,f,p,Ft())).next(E=>({batchId:c,changes:aa(E)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new H(e)).next(i=>{let s=lr();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(t,e,i,s){const o=e.collectionGroup;let l=lr();return this.indexManager.getCollectionParents(t,o).next(c=>P.forEach(c,f=>{const p=function(R,w){return new Cr(w,null,R.explicitOrderBy.slice(),R.filters.slice(),R.limit,R.limitType,R.startAt,R.endAt)}(e,f.child(o));return this.getDocumentsMatchingCollectionQuery(t,p,i,s).next(E=>{E.forEach((R,w)=>{l=l.insert(R,w)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(t,e,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next(l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,o,s))).next(l=>{o.forEach((f,p)=>{const E=p.getKey();l.get(E)===null&&(l=l.insert(E,re.newInvalidDocument(E)))});let c=lr();return l.forEach((f,p)=>{const E=o.get(f);E!==void 0&&Vn(E.mutation,p,oe.empty(),Pt.now()),Di(e,p)&&(c=c.insert(f,p))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return P.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(s){return{id:s.id,version:s.version,createTime:Xe(s.createTime)}}(e)),P.resolve()}getNamedQuery(t,e){return P.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(s){return{name:s.name,query:vh(s.bundledQuery),readTime:Xe(s.readTime)}}(e)),P.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(){this.overlays=new Kt(H.comparator),this.hr=new Map}getOverlay(t,e){return P.resolve(this.overlays.get(e))}getOverlays(t,e){const i=De();return P.forEach(e,s=>this.getOverlay(t,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(t,e,i){return i.forEach((s,o)=>{this.ht(t,e,o)}),P.resolve()}removeOverlaysForBatchId(t,e,i){const s=this.hr.get(i);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.hr.delete(i)),P.resolve()}getOverlaysForCollection(t,e,i){const s=De(),o=e.length+1,l=new H(e.child("")),c=this.overlays.getIteratorFrom(l);for(;c.hasNext();){const f=c.getNext().value,p=f.getKey();if(!e.isPrefixOf(p.path))break;p.path.length===o&&f.largestBatchId>i&&s.set(f.getKey(),f)}return P.resolve(s)}getOverlaysForCollectionGroup(t,e,i,s){let o=new Kt((p,E)=>p-E);const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===e&&p.largestBatchId>i){let E=o.get(p.largestBatchId);E===null&&(E=De(),o=o.insert(p.largestBatchId,E)),E.set(p.getKey(),p)}}const c=De(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach((p,E)=>c.set(p,E)),!(c.size()>=s)););return P.resolve(c)}ht(t,e,i){const s=this.overlays.get(i.key);if(s!==null){const l=this.hr.get(s.largestBatchId).delete(i.key);this.hr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new rh(e,i));let o=this.hr.get(e);o===void 0&&(o=Ft(),this.hr.set(e,o)),this.hr.set(e,o.add(i.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){this.Pr=new $t(At.Ir),this.Tr=new $t(At.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const i=new At(t,e);this.Pr=this.Pr.add(i),this.Tr=this.Tr.add(i)}dr(t,e){t.forEach(i=>this.addReference(i,e))}removeReference(t,e){this.Ar(new At(t,e))}Rr(t,e){t.forEach(i=>this.removeReference(i,e))}Vr(t){const e=new H(new yt([])),i=new At(e,t),s=new At(e,t+1),o=[];return this.Tr.forEachInRange([i,s],l=>{this.Ar(l),o.push(l.key)}),o}mr(){this.Pr.forEach(t=>this.Ar(t))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new H(new yt([])),i=new At(e,t),s=new At(e,t+1);let o=Ft();return this.Tr.forEachInRange([i,s],l=>{o=o.add(l.key)}),o}containsKey(t){const e=new At(t,0),i=this.Pr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class At{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return H.comparator(t.key,e.key)||it(t.pr,e.pr)}static Er(t,e){return it(t.pr,e.pr)||H.comparator(t.key,e.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new $t(At.Ir)}checkEmpty(t){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,s){const o=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new nh(o,e,i,s);this.mutationQueue.push(l);for(const c of s)this.wr=this.wr.add(new At(c.key,o)),this.indexManager.addToCollectionParentIndex(t,c.key.path.popLast());return P.resolve(l)}lookupMutationBatch(t,e){return P.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,s=this.br(i),o=s<0?0:s;return P.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(t){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new At(e,0),s=new At(e,Number.POSITIVE_INFINITY),o=[];return this.wr.forEachInRange([i,s],l=>{const c=this.Sr(l.pr);o.push(c)}),P.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new $t(it);return e.forEach(s=>{const o=new At(s,0),l=new At(s,Number.POSITIVE_INFINITY);this.wr.forEachInRange([o,l],c=>{i=i.add(c.pr)})}),P.resolve(this.Dr(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,s=i.length+1;let o=i;H.isDocumentKey(o)||(o=o.child(""));const l=new At(new H(o),0);let c=new $t(it);return this.wr.forEachWhile(f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(c=c.add(f.pr)),!0)},l),P.resolve(this.Dr(c))}Dr(t){const e=[];return t.forEach(i=>{const s=this.Sr(i);s!==null&&e.push(s)}),e}removeMutationBatch(t,e){Ct(this.Cr(e.batchId,"removed")===0),this.mutationQueue.shift();let i=this.wr;return P.forEach(e.mutations,s=>{const o=new At(s.key,e.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)}).next(()=>{this.wr=i})}Mn(t){}containsKey(t,e){const i=new At(e,0),s=this.wr.firstAfterOrEqual(i);return P.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,P.resolve()}Cr(t,e){return this.br(t)}br(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(t){this.vr=t,this.docs=function(){return new Kt(H.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,s=this.docs.get(i),o=s?s.size:0,l=this.vr(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return P.resolve(i?i.document.mutableCopy():re.newInvalidDocument(e))}getEntries(t,e){let i=Ir();return e.forEach(s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():re.newInvalidDocument(s))}),P.resolve(i)}getDocumentsMatchingQuery(t,e,i,s){let o=Ir();const l=e.path,c=new H(l.child("")),f=this.docs.getIteratorFrom(c);for(;f.hasNext();){const{key:p,value:{document:E}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||yc(_c(E),i)<=0||(s.has(E.key)||Di(e,E))&&(o=o.insert(E.key,E.mutableCopy()))}return P.resolve(o)}getAllFromCollectionGroup(t,e,i,s){K()}Fr(t,e){return P.forEach(this.docs,i=>e(i))}newChangeBuffer(t){return new bh(this)}getSize(t){return P.resolve(this.size)}}class bh extends Ih{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?e.push(this.ar.addEntry(t,s)):this.ar.removeEntry(i)}),P.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(t){this.persistence=t,this.Mr=new on(e=>bi(e),Vi),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ni,this.targetCount=0,this.Lr=nn.Nn()}forEachTarget(t,e){return this.Mr.forEach((i,s)=>e(s)),P.resolve()}getLastRemoteSnapshotVersion(t){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return P.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Lr.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.Or&&(this.Or=e),P.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Lr=new nn(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,P.resolve()}updateTargetData(t,e){return this.qn(e),P.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,P.resolve()}removeTargets(t,e,i){let s=0;const o=[];return this.Mr.forEach((l,c)=>{c.sequenceNumber<=e&&i.get(c.targetId)===null&&(this.Mr.delete(l),o.push(this.removeMatchingKeysForTargetId(t,c.targetId)),s++)}),P.waitFor(o).next(()=>s)}getTargetCount(t){return P.resolve(this.targetCount)}getTargetData(t,e){const i=this.Mr.get(e)||null;return P.resolve(i)}addMatchingKeys(t,e,i){return this.Nr.dr(e,i),P.resolve()}removeMatchingKeys(t,e,i){this.Nr.Rr(e,i);const s=this.persistence.referenceDelegate,o=[];return s&&e.forEach(l=>{o.push(s.markPotentiallyOrphaned(t,l))}),P.waitFor(o)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),P.resolve()}getMatchingKeysForTargetId(t,e){const i=this.Nr.gr(e);return P.resolve(i)}containsKey(t,e){return P.resolve(this.Nr.containsKey(e))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(t,e){this.Br={},this.overlays={},this.kr=new Qo(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Vh(this),this.indexManager=new Eh,this.remoteDocumentCache=function(s){return new Sh(s)}(i=>this.referenceDelegate.Kr(i)),this.serializer=new yh(e),this.$r=new Rh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Ph,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.Br[t.toKey()];return i||(i=new Ch(e,this.referenceDelegate),this.Br[t.toKey()]=i),i}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,i){M("MemoryPersistence","Starting transaction:",t);const s=new xh(this.kr.next());return this.referenceDelegate.Ur(),i(s).next(o=>this.referenceDelegate.Wr(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Gr(t,e){return P.or(Object.values(this.Br).map(i=>()=>i.containsKey(t,e)))}}class xh extends Ec{constructor(t){super(),this.currentSequenceNumber=t}}class ki{constructor(t){this.persistence=t,this.zr=new Ni,this.jr=null}static Hr(t){return new ki(t)}get Jr(){if(this.jr)return this.jr;throw K()}addReference(t,e,i){return this.zr.addReference(i,e),this.Jr.delete(i.toString()),P.resolve()}removeReference(t,e,i){return this.zr.removeReference(i,e),this.Jr.add(i.toString()),P.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),P.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach(s=>this.Jr.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next(s=>{s.forEach(o=>this.Jr.add(o.toString()))}).next(()=>i.removeTargetData(t,e))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.Jr,i=>{const s=H.fromPath(i);return this.Yr(t,s).next(o=>{o||e.removeEntry(s,lt.min())})}).next(()=>(this.jr=null,e.apply(t)))}updateLimboDocument(t,e){return this.Yr(t,e).next(i=>{i?this.Jr.delete(e.toString()):this.Jr.add(e.toString())})}Kr(t){return 0}Yr(t,e){return P.or([()=>P.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(t,e,i,s){this.targetId=t,this.fromCache=e,this.qi=i,this.Qi=s}static Ki(t,e){let i=Ft(),s=Ft();for(const o of e.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Mi(t,e.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Gl()?8:Tc(Hl())>0?6:4}()}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,i,s){const o={result:null};return this.ji(t,e).next(l=>{o.result=l}).next(()=>{if(!o.result)return this.Hi(t,e,s,i).next(l=>{o.result=l})}).next(()=>{if(o.result)return;const l=new Nh;return this.Ji(t,e,l).next(c=>{if(o.result=c,this.Ui)return this.Yi(t,e,l,c.size)})}).next(()=>o.result)}Yi(t,e,i,s){return i.documentReadCount<this.Wi?(An()<=Y.DEBUG&&M("QueryEngine","SDK will not create cache indexes for query:",Rn(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),P.resolve()):(An()<=Y.DEBUG&&M("QueryEngine","Query:",Rn(e),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.Gi*s?(An()<=Y.DEBUG&&M("QueryEngine","The SDK decides to create cache indexes for query:",Rn(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ne(e))):P.resolve())}ji(t,e){if(oo(e))return P.resolve(null);let i=Ne(e);return this.indexManager.getIndexType(t,i).next(s=>s===0?null:(e.limit!==null&&s===1&&(e=yi(e,null,"F"),i=Ne(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next(o=>{const l=Ft(...o);return this.zi.getDocuments(t,l).next(c=>this.indexManager.getMinOffset(t,i).next(f=>{const p=this.Zi(e,c);return this.Xi(e,p,l,f.readTime)?this.ji(t,yi(e,null,"F")):this.es(t,p,e,f)}))})))}Hi(t,e,i,s){return oo(e)||s.isEqual(lt.min())?P.resolve(null):this.zi.getDocuments(t,i).next(o=>{const l=this.Zi(e,o);return this.Xi(e,l,i,s)?P.resolve(null):(An()<=Y.DEBUG&&M("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Rn(e)),this.es(t,l,e,gc(s,-1)).next(c=>c))})}Zi(t,e){let i=new $t(Bc(t));return e.forEach((s,o)=>{Di(t,o)&&(i=i.add(o))}),i}Xi(t,e,i,s){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const o=t.limitType==="F"?e.last():e.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ji(t,e,i){return An()<=Y.DEBUG&&M("QueryEngine","Using full collection scan to execute query:",Rn(e)),this.zi.getDocumentsMatchingQuery(t,e,Ie.min(),i)}es(t,e,i,s){return this.zi.getDocumentsMatchingQuery(t,i,s).next(o=>(e.forEach(l=>{o=o.insert(l.key,l)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(t,e,i,s){this.persistence=t,this.ts=e,this.serializer=s,this.ns=new Kt(it),this.rs=new on(o=>bi(o),Vi),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(i)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Ah(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.ns))}}function Oh(n,t,e,i){return new Mh(n,t,e,i)}async function Ea(n,t){const e=ot(n);return await e.persistence.runTransaction("Handle user change","readonly",i=>{let s;return e.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,e._s(t),e.mutationQueue.getAllMutationBatches(i))).next(o=>{const l=[],c=[];let f=Ft();for(const p of s){l.push(p.batchId);for(const E of p.mutations)f=f.add(E.key)}for(const p of o){c.push(p.batchId);for(const E of p.mutations)f=f.add(E.key)}return e.localDocuments.getDocuments(i,f).next(p=>({us:p,removedBatchIds:l,addedBatchIds:c}))})})}function Lh(n,t){const e=ot(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=t.batch.keys(),o=e.os.newChangeBuffer({trackRemovals:!0});return function(c,f,p,E){const R=p.batch,w=R.keys();let S=P.resolve();return w.forEach(D=>{S=S.next(()=>E.getEntry(f,D)).next(N=>{const x=p.docVersions.get(D);Ct(x!==null),N.version.compareTo(x)<0&&(R.applyToRemoteDocument(N,p),N.isValidDocument()&&(N.setReadTime(p.commitVersion),E.addEntry(N)))})}),S.next(()=>c.mutationQueue.removeMutationBatch(f,R))}(e,i,t,o).next(()=>o.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,s,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(c){let f=Ft();for(let p=0;p<c.mutationResults.length;++p)c.mutationResults[p].transformResults.length>0&&(f=f.add(c.batch.mutations[p].key));return f}(t))).next(()=>e.localDocuments.getDocuments(i,s))})}function Fh(n){const t=ot(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Qr.getLastRemoteSnapshotVersion(e))}function $h(n,t){const e=ot(n);return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}class fo{constructor(){this.activeTargetIds=Kc()}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Uh{constructor(){this.no=new fo,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,i){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new fo,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{io(t){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){M("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){M("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ur=null;function ii(){return ur===null?ur=function(){return 268435456+Math.round(2147483648*Math.random())}():ur++,"0x"+ur.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}Ao(t){this.Ro=t}onMessage(t){this.Vo=t}close(){this.ho()}send(t){this.lo(t)}mo(){this.Io()}fo(){this.Eo()}po(t){this.Ro(t)}yo(t){this.Vo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ot="WebChannelConnection";class Hh extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const i=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.wo=i+"://"+e.host,this.So=`projects/${s}/databases/${o}`,this.bo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${o}`}get Do(){return!1}Co(e,i,s,o,l){const c=ii(),f=this.vo(e,i.toUriEncodedString());M("RestConnection",`Sending RPC '${e}' ${c}:`,f,s);const p={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(p,o,l),this.Mo(e,f,p,s).then(E=>(M("RestConnection",`Received RPC '${e}' ${c}: `,E),E),E=>{throw gr("RestConnection",`RPC '${e}' ${c} failed with error: `,E,"url: ",f,"request:",s),E})}xo(e,i,s,o,l,c){return this.Co(e,i,s,o,l)}Fo(e,i,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+sn}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((o,l)=>e[l]=o),s&&s.headers.forEach((o,l)=>e[l]=o)}vo(e,i){const s=jh[e];return`${this.wo}/v1/${i}:${s}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Mo(t,e,i,s){const o=ii();return new Promise((l,c)=>{const f=new $o;f.setWithCredentials(!0),f.listenOnce(Bo.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case cr.NO_ERROR:const E=f.getResponseJson();M(Ot,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(E)),l(E);break;case cr.TIMEOUT:M(Ot,`RPC '${t}' ${o} timed out`),c(new $(C.DEADLINE_EXCEEDED,"Request time out"));break;case cr.HTTP_ERROR:const R=f.getStatus();if(M(Ot,`RPC '${t}' ${o} failed with status:`,R,"response text:",f.getResponseText()),R>0){let w=f.getResponseJson();Array.isArray(w)&&(w=w[0]);const S=w==null?void 0:w.error;if(S&&S.status&&S.message){const D=function(x){const B=x.toLowerCase().replace(/_/g,"-");return Object.values(C).indexOf(B)>=0?B:C.UNKNOWN}(S.status);c(new $(D,S.message))}else c(new $(C.UNKNOWN,"Server responded with status "+f.getStatus()))}else c(new $(C.UNAVAILABLE,"Connection failed."));break;default:K()}}finally{M(Ot,`RPC '${t}' ${o} completed.`)}});const p=JSON.stringify(s);M(Ot,`RPC '${t}' ${o} sending request:`,s),f.send(e,"POST",p,i,15)})}Oo(t,e,i){const s=ii(),o=[this.wo,"/","google.firestore.v1.Firestore","/",t,"/channel"],l=Ho(),c=zo(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.xmlHttpFactory=new Uo({})),this.Fo(f.initMessageHeaders,e,i),f.encodeInitMessageHeaders=!0;const E=o.join("");M(Ot,`Creating RPC '${t}' stream ${s}: ${E}`,f);const R=l.createWebChannel(E,f);let w=!1,S=!1;const D=new zh({lo:x=>{S?M(Ot,`Not sending because RPC '${t}' stream ${s} is closed:`,x):(w||(M(Ot,`Opening RPC '${t}' stream ${s} transport.`),R.open(),w=!0),M(Ot,`RPC '${t}' stream ${s} sending:`,x),R.send(x))},ho:()=>R.close()}),N=(x,B,O)=>{x.listen(B,q=>{try{O(q)}catch(X){setTimeout(()=>{throw X},0)}})};return N(R,Pn.EventType.OPEN,()=>{S||(M(Ot,`RPC '${t}' stream ${s} transport opened.`),D.mo())}),N(R,Pn.EventType.CLOSE,()=>{S||(S=!0,M(Ot,`RPC '${t}' stream ${s} transport closed`),D.po())}),N(R,Pn.EventType.ERROR,x=>{S||(S=!0,gr(Ot,`RPC '${t}' stream ${s} transport errored:`,x),D.po(new $(C.UNAVAILABLE,"The operation could not be completed")))}),N(R,Pn.EventType.MESSAGE,x=>{var B;if(!S){const O=x.data[0];Ct(!!O);const q=O,X=q.error||((B=q[0])===null||B===void 0?void 0:B.error);if(X){M(Ot,`RPC '${t}' stream ${s} received error:`,X);const U=X.status;let G=function(g){const _=Tt[g];if(_!==void 0)return sh(_)}(U),y=X.message;G===void 0&&(G=C.INTERNAL,y="Unknown error status: "+U+" with message "+X.message),S=!0,D.po(new $(G,y)),R.close()}else M(Ot,`RPC '${t}' stream ${s} received:`,O),D.yo(O)}}),N(c,jo.STAT_EVENT,x=>{x.stat===pi.PROXY?M(Ot,`RPC '${t}' stream ${s} detected buffering proxy`):x.stat===pi.NOPROXY&&M(Ot,`RPC '${t}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{D.fo()},0),D}}function si(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vr(n){return new oh(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(t,e,i=1e3,s=1.5,o=6e4){this.oi=t,this.timerId=e,this.No=i,this.Lo=s,this.Bo=o,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(t){this.cancel();const e=Math.floor(this.ko+this.Uo()),i=Math.max(0,Date.now()-this.Qo),s=Math.max(0,e-i);s>0&&M("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.ko} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,s,()=>(this.Qo=Date.now(),t())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(t,e,i,s,o,l,c,f){this.oi=t,this.Go=i,this.zo=s,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=c,this.listener=f,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new Ta(t,e)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(t){this.s_(),this.stream.send(t)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(t,e){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,t!==4?this.Yo.reset():e&&e.code===C.RESOURCE_EXHAUSTED?(Oe(e.toString()),Oe("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):e&&e.code===C.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Ao(e)}__(){}auth(){this.state=1;const t=this.a_(this.jo),e=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.jo===e&&this.u_(i,s)},i=>{t(()=>{const s=new $(C.UNKNOWN,"Fetching auth token failed: "+i.message);return this.c_(s)})})}u_(t,e){const i=this.a_(this.jo);this.stream=this.l_(t,e),this.stream.Po(()=>{i(()=>this.listener.Po())}),this.stream.To(()=>{i(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(s=>{i(()=>this.c_(s))}),this.stream.onMessage(s=>{i(()=>this.onMessage(s))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_(t){return M("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}a_(t){return e=>{this.oi.enqueueAndForget(()=>this.jo===t?e():(M("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Gh extends qh{constructor(t,e,i,s,o,l){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,s,l),this.serializer=o,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(t,e){return this.connection.Oo("Write",t,e)}onMessage(t){if(Ct(!!t.streamToken),this.lastStreamToken=t.streamToken,this.T_){this.Yo.reset();const e=ph(t.writeResults,t.commitTime),i=Xe(t.commitTime);return this.listener.A_(i,e)}return Ct(!t.writeResults||t.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){const t={};t.database=hh(this.serializer),this.i_(t)}d_(t){const e={streamToken:this.lastStreamToken,writes:t.map(i=>dh(this.serializer,i))};this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh extends class{}{constructor(t,e,i,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=s,this.m_=!1}f_(){if(this.m_)throw new $(C.FAILED_PRECONDITION,"The client has already been terminated.")}Co(t,e,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Co(t,Ei(e,i),s,o,l)).catch(o=>{throw o.name==="FirebaseError"?(o.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $(C.UNKNOWN,o.toString())})}xo(t,e,i,s,o){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,c])=>this.connection.xo(t,Ei(e,i),s,l,c,o)).catch(l=>{throw l.name==="FirebaseError"?(l.code===C.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new $(C.UNKNOWN,l.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class Qh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(t){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.S_("Offline")))}set(t){this.C_(),this.g_=0,t==="Online"&&(this.y_=!1),this.S_(t)}S_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}b_(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Oe(e),this.y_=!1):M("OnlineStateTracker",e)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(t,e,i,s,o){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=o,this.O_.io(l=>{i.enqueueAndForget(async()=>{zn(this)&&(M("RemoteStore","Restarting streams for network reachability change."),await async function(f){const p=ot(f);p.M_.add(4),await jn(p),p.N_.set("Unknown"),p.M_.delete(4),await Dr(p)}(this))})}),this.N_=new Qh(i,s)}}async function Dr(n){if(zn(n))for(const t of n.x_)await t(!0)}async function jn(n){for(const t of n.x_)await t(!1)}function zn(n){return ot(n).M_.size===0}async function Ia(n,t,e){if(!Pr(t))throw t;n.M_.add(1),await jn(n),n.N_.set("Offline"),e||(e=()=>Fh(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{M("RemoteStore","Retrying IndexedDB access"),await e(),n.M_.delete(1),await Dr(n)})}function wa(n,t){return t().catch(e=>Ia(n,e,t))}async function xr(n){const t=ot(n),e=Ae(t);let i=t.v_.length>0?t.v_[t.v_.length-1].batchId:-1;for(;Xh(t);)try{const s=await $h(t.localStore,i);if(s===null){t.v_.length===0&&e.n_();break}i=s.batchId,Yh(t,s)}catch(s){await Ia(t,s)}Aa(t)&&Ra(t)}function Xh(n){return zn(n)&&n.v_.length<10}function Yh(n,t){n.v_.push(t);const e=Ae(n);e.Xo()&&e.E_&&e.d_(t.mutations)}function Aa(n){return zn(n)&&!Ae(n).Zo()&&n.v_.length>0}function Ra(n){Ae(n).start()}async function Jh(n){Ae(n).V_()}async function Zh(n){const t=Ae(n);for(const e of n.v_)t.d_(e.mutations)}async function tf(n,t,e){const i=n.v_.shift(),s=xi.from(i,t,e);await wa(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await xr(n)}async function ef(n,t){t&&Ae(n).E_&&await async function(i,s){if(function(l){return ih(l)&&l!==C.ABORTED}(s.code)){const o=i.v_.shift();Ae(i).t_(),await wa(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),await xr(i)}}(n,t),Aa(n)&&Ra(n)}async function mo(n,t){const e=ot(n);e.asyncQueue.verifyOperationInProgress(),M("RemoteStore","RemoteStore received new credentials");const i=zn(e);e.M_.add(3),await jn(e),i&&e.N_.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.M_.delete(3),await Dr(e)}async function nf(n,t){const e=ot(n);t?(e.M_.delete(2),await Dr(e)):t||(e.M_.add(2),await jn(e),e.N_.set("Unknown"))}function Ae(n){return n.k_||(n.k_=function(e,i,s){const o=ot(e);return o.f_(),new Gh(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:Jh.bind(null,n),Ao:ef.bind(null,n),R_:Zh.bind(null,n),A_:tf.bind(null,n)}),n.x_.push(async t=>{t?(n.k_.t_(),await xr(n)):(await n.k_.stop(),n.v_.length>0&&(M("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))})),n.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(t,e,i,s,o){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new xe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,s,o){const l=Date.now()+i,c=new Oi(t,e,l,s,o);return c.start(i),c}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $(C.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pa(n,t){if(Oe("AsyncQueue",`${t}: ${n}`),Pr(n))return new $(C.UNAVAILABLE,`${t}: ${n}`);throw n}class rf{constructor(){this.queries=new on(t=>sa(t),ia),this.onlineState="Unknown",this.z_=new Set}}function sf(n){n.z_.forEach(t=>{t.next()})}var go,_o;(_o=go||(go={})).J_="default",_o.Cache="cache";class of{constructor(t,e,i,s,o,l){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Sa={},this.ba=new on(c=>sa(c),ia),this.Da=new Map,this.Ca=new Set,this.va=new Kt(H.comparator),this.Fa=new Map,this.Ma=new Ni,this.xa={},this.Oa=new Map,this.Na=nn.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function af(n,t,e){const i=hf(n);try{const s=await function(l,c){const f=ot(l),p=Pt.now(),E=c.reduce((S,D)=>S.add(D.key),Ft());let R,w;return f.persistence.runTransaction("Locally write mutations","readwrite",S=>{let D=Ir(),N=Ft();return f.os.getEntries(S,E).next(x=>{D=x,D.forEach((B,O)=>{O.isValidDocument()||(N=N.add(B))})}).next(()=>f.localDocuments.getOverlayedDocuments(S,D)).next(x=>{R=x;const B=[];for(const O of c){const q=th(O,R.get(O.key).overlayedDocument);q!=null&&B.push(new Be(O.key,q,Yo(q.value.mapValue),de.exists(!0)))}return f.mutationQueue.addMutationBatch(S,p,B,c)}).next(x=>{w=x;const B=x.applyToLocalDocumentSet(R,N);return f.documentOverlayCache.saveOverlays(S,x.batchId,B)})}).then(()=>({batchId:w.batchId,changes:aa(R)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(s.batchId),function(l,c,f){let p=l.xa[l.currentUser.toKey()];p||(p=new Kt(it)),p=p.insert(c,f),l.xa[l.currentUser.toKey()]=p}(i,s.batchId,e),await Nr(i,s.changes),await xr(i.remoteStore)}catch(s){const o=Pa(s,"Failed to persist write");e.reject(o)}}function yo(n,t,e){const i=ot(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const s=[];i.ba.forEach((o,l)=>{const c=l.view.j_(t);c.snapshot&&s.push(c.snapshot)}),function(l,c){const f=ot(l);f.onlineState=c;let p=!1;f.queries.forEach((E,R)=>{for(const w of R.U_)w.j_(c)&&(p=!0)}),p&&sf(f)}(i.eventManager,t),s.length&&i.Sa.h_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function lf(n,t){const e=ot(n),i=t.batch.batchId;try{const s=await Lh(e.localStore,t);Sa(e,i,null),Ca(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await Nr(e,s)}catch(s){await Ko(s)}}async function uf(n,t,e){const i=ot(n);try{const s=await function(l,c){const f=ot(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let E;return f.mutationQueue.lookupMutationBatch(p,c).next(R=>(Ct(R!==null),E=R.keys(),f.mutationQueue.removeMutationBatch(p,R))).next(()=>f.mutationQueue.performConsistencyCheck(p)).next(()=>f.documentOverlayCache.removeOverlaysForBatchId(p,E,c)).next(()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,E)).next(()=>f.localDocuments.getDocuments(p,E))})}(i.localStore,t);Sa(i,t,e),Ca(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await Nr(i,s)}catch(s){await Ko(s)}}function Ca(n,t){(n.Oa.get(t)||[]).forEach(e=>{e.resolve()}),n.Oa.delete(t)}function Sa(n,t,e){const i=ot(n);let s=i.xa[i.currentUser.toKey()];if(s){const o=s.get(t);o&&(e?o.reject(e):o.resolve(),s=s.remove(t)),i.xa[i.currentUser.toKey()]=s}}async function Nr(n,t,e){const i=ot(n),s=[],o=[],l=[];i.ba.isEmpty()||(i.ba.forEach((c,f)=>{l.push(i.Ba(f,t,e).then(p=>{if((p||e)&&i.isPrimaryClient){const E=p&&!p.fromCache;i.sharedClientState.updateQueryState(f.targetId,E?"current":"not-current")}if(p){s.push(p);const E=Mi.Ki(f.targetId,p);o.push(E)}}))}),await Promise.all(l),i.Sa.h_(s),await async function(f,p){const E=ot(f);try{await E.persistence.runTransaction("notifyLocalViewChanges","readwrite",R=>P.forEach(p,w=>P.forEach(w.qi,S=>E.persistence.referenceDelegate.addReference(R,w.targetId,S)).next(()=>P.forEach(w.Qi,S=>E.persistence.referenceDelegate.removeReference(R,w.targetId,S)))))}catch(R){if(!Pr(R))throw R;M("LocalStore","Failed to update sequence numbers: "+R)}for(const R of p){const w=R.targetId;if(!R.fromCache){const S=E.ns.get(w),D=S.snapshotVersion,N=S.withLastLimboFreeSnapshotVersion(D);E.ns=E.ns.insert(w,N)}}}(i.localStore,o))}async function cf(n,t){const e=ot(n);if(!e.currentUser.isEqual(t)){M("SyncEngine","User change. New user:",t.toKey());const i=await Ea(e.localStore,t);e.currentUser=t,function(o,l){o.Oa.forEach(c=>{c.forEach(f=>{f.reject(new $(C.CANCELLED,l))})}),o.Oa.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await Nr(e,i.us)}}function hf(n){const t=ot(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=lf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=uf.bind(null,t),t}class vo{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Vr(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return Oh(this.persistence,new kh,t.initialUser,this.serializer)}createPersistence(t){return new Dh(ki.Hr,this.serializer)}createSharedClientState(t){return new Uh}async terminate(){var t,e;(t=this.gcScheduler)===null||t===void 0||t.stop(),(e=this.indexBackfillerScheduler)===null||e===void 0||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ff{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>yo(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=cf.bind(null,this.syncEngine),await nf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return function(){return new rf}()}createDatastore(t){const e=Vr(t.databaseInfo.databaseId),i=function(o){return new Hh(o)}(t.databaseInfo);return function(o,l,c,f){return new Kh(o,l,c,f)}(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return function(i,s,o,l,c){return new Wh(i,s,o,l,c)}(this.localStore,this.datastore,t.asyncQueue,e=>yo(this.syncEngine,e,0),function(){return po.D()?new po:new Bh}())}createSyncEngine(t,e){return function(s,o,l,c,f,p,E){const R=new of(s,o,l,c,f,p);return E&&(R.La=!0),R}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(i){const s=ot(i);M("RemoteStore","RemoteStore shutting down."),s.M_.add(5),await jn(s),s.O_.shutdown(),s.N_.set("Unknown")}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(t,e,i,s){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=s,this.user=Lt.UNAUTHENTICATED,this.clientId=Go.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,async o=>{M("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(i,o=>(M("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new $(C.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new xe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=Pa(e,"Failed to shutdown persistence");t.reject(i)}}),t.promise}}async function oi(n,t){n.asyncQueue.verifyOperationInProgress(),M("FirestoreClient","Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener(async s=>{i.isEqual(s)||(await Ea(t.localStore,s),i=s)}),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t}async function Eo(n,t){n.asyncQueue.verifyOperationInProgress();const e=await mf(n);M("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener(i=>mo(t.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>mo(t.remoteStore,s)),n._onlineComponents=t}function pf(n){return n.name==="FirebaseError"?n.code===C.FAILED_PRECONDITION||n.code===C.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function mf(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){M("FirestoreClient","Using user provided OfflineComponentProvider");try{await oi(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!pf(e))throw e;gr("Error using user provided cache. Falling back to memory cache: "+e),await oi(n,new vo)}}else M("FirestoreClient","Using default OfflineComponentProvider"),await oi(n,new vo);return n._offlineComponents}async function gf(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(M("FirestoreClient","Using user provided OnlineComponentProvider"),await Eo(n,n._uninitializedComponentsProvider._online)):(M("FirestoreClient","Using default OnlineComponentProvider"),await Eo(n,new ff))),n._onlineComponents}function _f(n){return gf(n).then(t=>t.syncEngine)}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ba(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(n,t,e){if(!e)throw new $(C.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function yf(n,t,e,i){if(t===!0&&i===!0)throw new $(C.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function Io(n){if(!H.isDocumentKey(n))throw new $(C.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function wo(n){if(H.isDocumentKey(n))throw new $(C.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Li(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=function(i){return i.constructor?i.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":K()}function Ii(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new $(C.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=Li(n);throw new $(C.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(t){var e,i;if(t.host===void 0){if(t.ssl!==void 0)throw new $(C.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(e=t.ssl)===null||e===void 0||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new $(C.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}yf("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ba((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new $(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new $(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new $(C.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class kr{constructor(t,e,i,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ao({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new $(C.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new $(C.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ao(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new ac;switch(i.type){case"firstParty":return new hc(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new $(C.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const i=To.get(e);i&&(M("ComponentProvider","Removing Datastore"),To.delete(e),i.terminate())}(this),Promise.resolve()}}function vf(n,t,e,i={}){var s;const o=(n=Ii(n,kr))._getSettings(),l=`${t}:${e}`;if(o.host!=="firestore.googleapis.com"&&o.host!==l&&gr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:l,ssl:!1})),i.mockUserToken){let c,f;if(typeof i.mockUserToken=="string")c=i.mockUserToken,f=Lt.MOCK_USER;else{c=zl(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const p=i.mockUserToken.sub||i.mockUserToken.user_id;if(!p)throw new $(C.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Lt(p)}n._authCredentials=new lc(new qo(c,f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Fi(this.firestore,t,this._query)}}class ue{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Te(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ue(this.firestore,t,this._key)}}class Te extends Fi{constructor(t,e,i){super(t,e,Fc(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ue(this.firestore,null,new H(t))}withConverter(t){return new Te(this.firestore,t,this._path)}}function Ef(n,t,...e){if(n=Dn(n),Va("collection","path",t),n instanceof kr){const i=yt.fromString(t,...e);return wo(i),new Te(n,null,i)}{if(!(n instanceof ue||n instanceof Te))throw new $(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(yt.fromString(t,...e));return wo(i),new Te(n.firestore,null,i)}}function Tf(n,t,...e){if(n=Dn(n),arguments.length===1&&(t=Go.newId()),Va("doc","path",t),n instanceof kr){const i=yt.fromString(t,...e);return Io(i),new ue(n,null,new H(i))}{if(!(n instanceof ue||n instanceof Te))throw new $(C.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(yt.fromString(t,...e));return Io(i),new ue(n.firestore,n instanceof Te?n.converter:null,new H(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new Ta(this,"async_queue_retry"),this.hu=()=>{const e=si();e&&M("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Yo.Wo()};const t=si();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Pu(),this.Iu(t)}enterRestrictedMode(t){if(!this.ou){this.ou=!0,this.cu=t||!1;const e=si();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.hu)}}enqueue(t){if(this.Pu(),this.ou)return new Promise(()=>{});const e=new xe;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.su.push(t),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(t){if(!Pr(t))throw t;M("AsyncQueue","Operation failed with retryable error: "+t)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(t){const e=this.iu.then(()=>(this.uu=!0,t().catch(i=>{this.au=i,this.uu=!1;const s=function(l){let c=l.message||"";return l.stack&&(c=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),c}(i);throw Oe("INTERNAL UNHANDLED ERROR: ",s),i}).then(i=>(this.uu=!1,i))));return this.iu=e,e}enqueueAfterDelay(t,e,i){this.Pu(),this.lu.indexOf(t)>-1&&(e=0);const s=Oi.createAndSchedule(this,t,e,i,o=>this.Eu(o));return this._u.push(s),s}Pu(){this.au&&K()}verifyOperationInProgress(){}async du(){let t;do t=this.iu,await t;while(t!==this.iu)}Au(t){for(const e of this._u)if(e.timerId===t)return!0;return!1}Ru(t){return this.du().then(()=>{this._u.sort((e,i)=>e.targetTimeMs-i.targetTimeMs);for(const e of this._u)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.du()})}Vu(t){this.lu.push(t)}Eu(t){const e=this._u.indexOf(t);this._u.splice(e,1)}}class Da extends kr{constructor(t,e,i,s){super(t,e,i,s),this.type="firestore",this._queue=function(){return new If}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||xa(this),this._firestoreClient.terminate()}}function wf(n,t){const e=typeof n=="object"?n:Yu(),i=typeof n=="string"?n:"(default)",s=Ku(e,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=Bl("firestore");o&&vf(s,...o)}return s}function Af(n){return n._firestoreClient||xa(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function xa(n){var t,e,i;const s=n._freezeSettings(),o=function(c,f,p,E){return new Rc(c,f,p,E.host,E.ssl,E.experimentalForceLongPolling,E.experimentalAutoDetectLongPolling,ba(E.experimentalLongPollingOptions),E.useFetchStreams)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,s);n._firestoreClient=new df(n._authCredentials,n._appCheckCredentials,n._queue,o),!((e=s.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(t){this._byteString=t}static fromBase64String(t){try{return new $n(pe.fromBase64String(t))}catch(e){throw new $(C.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new $n(pe.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new $(C.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(t){this._methodName=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new $(C.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new $(C.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return it(this._lat,t._lat)||it(this._long,t._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf=/^__.*__$/;class Pf{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new Be(t,this.data,this.fieldMask,e,this.fieldTransforms):new Bn(t,this.data,e,this.fieldTransforms)}}function Oa(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K()}}class $i{constructor(t,e,i,s,o,l){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.mu(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(t){return new $i(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),s=this.gu({path:i,yu:!1});return s.wu(t),s}Su(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),s=this.gu({path:i,yu:!1});return s.mu(),s}bu(t){return this.gu({path:void 0,yu:!0})}Du(t){return Rr(t,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}mu(){if(this.path)for(let t=0;t<this.path.length;t++)this.wu(this.path.get(t))}wu(t){if(t.length===0)throw this.Du("Document fields must not be empty");if(Oa(this.fu)&&Rf.test(t))throw this.Du('Document fields cannot begin and end with "__"')}}class Cf{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||Vr(t)}Fu(t,e,i,s=!1){return new $i({fu:t,methodName:e,vu:i,path:Dt.emptyPath(),yu:!1,Cu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Sf(n){const t=n._freezeSettings(),e=Vr(n._databaseId);return new Cf(n._databaseId,!!t.ignoreUndefinedProperties,e)}function bf(n,t,e,i,s,o={}){const l=n.Fu(o.merge||o.mergeFields?2:0,t,e,s);Ua("Data must be an object, but it was:",l,i);const c=Fa(i,l);let f,p;if(o.merge)f=new oe(l.fieldMask),p=l.fieldTransforms;else if(o.mergeFields){const E=[];for(const R of o.mergeFields){const w=Vf(t,R,e);if(!l.contains(w))throw new $(C.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);Nf(E,w)||E.push(w)}f=new oe(E),p=l.fieldTransforms.filter(R=>f.covers(R.field))}else f=null,p=l.fieldTransforms;return new Pf(new se(c),f,p)}function La(n,t){if($a(n=Dn(n)))return Ua("Unsupported field value:",t,n),Fa(n,t);if(n instanceof ka)return function(i,s){if(!Oa(s.fu))throw s.Du(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Du(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.yu&&t.fu!==4)throw t.Du("Nested arrays are not supported");return function(i,s){const o=[];let l=0;for(const c of i){let f=La(c,s.bu(l));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),l++}return{arrayValue:{values:o}}}(n,t)}return function(i,s){if((i=Dn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return Qc(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=Pt.fromDate(i);return{timestampValue:vi(s.serializer,o)}}if(i instanceof Pt){const o=new Pt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:vi(s.serializer,o)}}if(i instanceof Ma)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof $n)return{bytesValue:ah(s.serializer,i._byteString)};if(i instanceof ue){const o=s.databaseId,l=i.firestore._databaseId;if(!l.isEqual(o))throw s.Du(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ya(i.firestore._databaseId||s.databaseId,i._key.path)}}throw s.Du(`Unsupported field value: ${Li(i)}`)}(n,t)}function Fa(n,t){const e={};return Wo(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Un(n,(i,s)=>{const o=La(s,t.pu(i));o!=null&&(e[i]=o)}),{mapValue:{fields:e}}}function $a(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Pt||n instanceof Ma||n instanceof $n||n instanceof ue||n instanceof ka)}function Ua(n,t,e){if(!$a(e)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(e)){const i=Li(e);throw i==="an object"?t.Du(n+" a custom object"):t.Du(n+" "+i)}}function Vf(n,t,e){if((t=Dn(t))instanceof Na)return t._internalPath;if(typeof t=="string")return xf(n,t);throw Rr("Field path arguments must be of type string or ",n,!1,void 0,e)}const Df=new RegExp("[~\\*/\\[\\]]");function xf(n,t,e){if(t.search(Df)>=0)throw Rr(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Na(...t.split("."))._internalPath}catch{throw Rr(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Rr(n,t,e,i,s){const o=i&&!i.isEmpty(),l=s!==void 0;let c=`Function ${t}() called with invalid data`;e&&(c+=" (via `toFirestore()`)"),c+=". ";let f="";return(o||l)&&(f+=" (found",o&&(f+=` in field ${i}`),l&&(f+=` in document ${s}`),f+=")"),new $(C.INVALID_ARGUMENT,c+n+f)}function Nf(n,t){return n.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(n,t,e){let i;return i=n?n.toFirestore(t):t,i}function Mf(n,t,e){n=Ii(n,ue);const i=Ii(n.firestore,Da),s=kf(n.converter,t);return Of(i,[bf(Sf(i),"setDoc",n._key,s,n.converter!==null,e).toMutation(n._key,de.none())])}function Of(n,t){return function(i,s){const o=new xe;return i.asyncQueue.enqueueAndForget(async()=>af(await _f(i),s,o)),o.promise}(Af(n),t)}(function(t,e=!0){(function(s){sn=s})(Xu),mr(new xn("firestore",(i,{instanceIdentifier:s,options:o})=>{const l=i.getProvider("app").getImmediate(),c=new Da(new uc(i.getProvider("auth-internal")),new dc(i.getProvider("app-check-internal")),function(p,E){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new $(C.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vr(p.options.projectId,E)}(l,s),l);return o=Object.assign({useFetchStreams:e},o),c._setSettings(o),c},"PUBLIC").setMultipleInstances(!0)),We(Zs,"4.6.3",t),We(Zs,"4.6.3","esm2017")})();var Lf="firebase",Ff="10.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */We(Lf,Ff,"app");const $f={apiKey:"AIzaSyBwD3AM0XKRsHnA0YU-CKTSSD4xcfDu9wU",authDomain:"upscayl.firebaseapp.com",projectId:"upscayl",storageBucket:"upscayl.appspot.com",messagingSenderId:"1096660154086",appId:"1:1096660154086:web:ec1872e9ceb11dad686d27"},Uf=Mo($f),Bf=wf(Uf),jf=n=>Ef(Bf,n),zf=jf("waitlist");function Hf(n){let t,e,i="Unleash Your Potential with Innovizta Cloud",s,o,l,c="Stop Waiting, Start Training.",f,p,E=`Say goodbye to hardware limitations. Innovizta Cloud provides affordable, powerful GPU compute designed for students. <br/>
			Focus on learning and experimenting with ML, not on your hardware specs.`,R,w,S,D,N,x,B,O,q,X,U,G,y,d,g,_,v="Ready to bring your ML projects to life without breaking the bank? <br/> Sign up now for early access and special student offers.",T,m,tt="Request Early Access",vt,It,rt,at,ee,Ht,qt,xt,et,Qt,Wt="Get Access",ut,Ut,Xt;S=new le({props:{icon:"ph:student-fill",text:"Made for Students, Priced for Students"}}),N=new le({props:{icon:"ph:lightning-fill",text:"Access High-Performance GPUs Instantly"}}),B=new le({props:{icon:"ph:code-block-fill",text:"Pre-configured with Popular ML Frameworks"}}),q=new le({props:{icon:"ph:timer-fill",text:"Pay-as-you-go, No Long-term Commitments"}}),U=new le({props:{icon:"ph:currency-dollar-fill",text:"The Most Affordable Way to Learn ML"}}),y=new le({props:{icon:"ph:lifebuoy-fill",text:"Full Support and Project Assistance"}});function ae(Q){n[2](Q)}let Gt={placeholder:"Your Name",type:"name"};n[0]!==void 0&&(Gt.value=n[0]),at=new Bs({props:Gt}),Fs.push(()=>Us(at,"value",ae));function Yt(Q){n[3](Q)}let Jt={placeholder:"Your Email",type:"email"};return n[1]!==void 0&&(Jt.value=n[1]),qt=new Bs({props:Jt}),Fs.push(()=>Us(qt,"value",Yt)),{c(){t=L("section"),e=L("h5"),e.textContent=i,s=j(),o=L("div"),l=L("h1"),l.textContent=c,f=j(),p=L("p"),p.innerHTML=E,R=j(),w=L("div"),ft(S.$$.fragment),D=j(),ft(N.$$.fragment),x=j(),ft(B.$$.fragment),O=j(),ft(q.$$.fragment),X=j(),ft(U.$$.fragment),G=j(),ft(y.$$.fragment),d=j(),g=L("div"),_=L("p"),_.innerHTML=v,T=j(),m=L("h3"),m.textContent=tt,vt=j(),It=L("div"),rt=L("div"),ft(at.$$.fragment),Ht=j(),ft(qt.$$.fragment),et=j(),Qt=L("button"),Qt.textContent=Wt,this.h()},l(Q){t=F(Q,"SECTION",{class:!0,id:!0});var Zt=Et(t);e=F(Zt,"H5",{class:!0,"data-svelte-h":!0}),ht(e)!=="svelte-iqs7ob"&&(e.textContent=i),s=z(Zt),o=F(Zt,"DIV",{class:!0});var Bt=Et(o);l=F(Bt,"H1",{class:!0,"data-svelte-h":!0}),ht(l)!=="svelte-8zzwhd"&&(l.textContent=c),f=z(Bt),p=F(Bt,"P",{class:!0,"data-svelte-h":!0}),ht(p)!=="svelte-1ku2pvj"&&(p.innerHTML=E),R=z(Bt),w=F(Bt,"DIV",{class:!0});var wt=Et(w);dt(S.$$.fragment,wt),D=z(wt),dt(N.$$.fragment,wt),x=z(wt),dt(B.$$.fragment,wt),O=z(wt),dt(q.$$.fragment,wt),X=z(wt),dt(U.$$.fragment,wt),G=z(wt),dt(y.$$.fragment,wt),wt.forEach(Z),d=z(Bt),g=F(Bt,"DIV",{class:!0,id:!0});var me=Et(g);_=F(me,"P",{class:!0,"data-svelte-h":!0}),ht(_)!=="svelte-1htcuae"&&(_.innerHTML=v),T=z(me),m=F(me,"H3",{class:!0,"data-svelte-h":!0}),ht(m)!=="svelte-3igk6q"&&(m.textContent=tt),vt=z(me),It=F(me,"DIV",{class:!0});var je=Et(It);rt=F(je,"DIV",{class:!0});var Re=Et(rt);dt(at.$$.fragment,Re),Ht=z(Re),dt(qt.$$.fragment,Re),Re.forEach(Z),et=z(je),Qt=F(je,"BUTTON",{class:!0,"data-svelte-h":!0}),ht(Qt)!=="svelte-15x90z2"&&(Qt.textContent=Wt),je.forEach(Z),me.forEach(Z),Bt.forEach(Z),Zt.forEach(Z),this.h()},h(){k(e,"class","text-center text-xs font-bold uppercase text-slate-500"),k(l,"class","text-center text-3xl font-semibold text-slate-200 sm:text-5xl"),k(p,"class","text-center text-slate-400 sm:max-w-2xl sm:text-xl"),k(w,"class","flex flex-col gap-3"),k(_,"class","max-w-md rounded-lg bg-slate-600/40 p-4 text-center text-sm font-light leading-tight text-slate-300"),k(m,"class","text-center text-3xl font-medium text-slate-300"),k(rt,"class","flex flex-col gap-4"),k(Qt,"class","ring-ring-500 rounded-full bg-green-600 px-8 py-3 font-medium text-green-200 ring-1 ring-green-500 transition-all duration-500 hover:bg-green-500"),k(It,"class","flex flex-col gap-5"),k(g,"class","flex flex-col gap-8 rounded-3xl bg-gradient-to-t from-slate-800 to-transparent px-4 py-20 sm:px-36"),k(g,"id","get-access"),k(o,"class","flex flex-col items-center gap-8"),k(t,"class","mt-20 flex min-h-screen max-w-full flex-col gap-10 overflow-hidden px-4 md:px-0"),k(t,"id","cloud")},m(Q,Zt){ie(Q,t,Zt),V(t,e),V(t,s),V(t,o),V(o,l),V(o,f),V(o,p),V(o,R),V(o,w),pt(S,w,null),V(w,D),pt(N,w,null),V(w,x),pt(B,w,null),V(w,O),pt(q,w,null),V(w,X),pt(U,w,null),V(w,G),pt(y,w,null),V(o,d),V(o,g),V(g,_),V(g,T),V(g,m),V(g,vt),V(g,It),V(It,rt),pt(at,rt,null),V(rt,Ht),pt(qt,rt,null),V(It,et),V(It,Qt),ut=!0,Ut||(Xt=Co(Qt,"click",n[4]),Ut=!0)},p(Q,[Zt]){const Bt={};!ee&&Zt&1&&(ee=!0,Bt.value=Q[0],$s(()=>ee=!1)),at.$set(Bt);const wt={};!xt&&Zt&2&&(xt=!0,wt.value=Q[1],$s(()=>xt=!1)),qt.$set(wt)},i(Q){ut||(mt(S.$$.fragment,Q),mt(N.$$.fragment,Q),mt(B.$$.fragment,Q),mt(q.$$.fragment,Q),mt(U.$$.fragment,Q),mt(y.$$.fragment,Q),mt(at.$$.fragment,Q),mt(qt.$$.fragment,Q),ut=!0)},o(Q){gt(S.$$.fragment,Q),gt(N.$$.fragment,Q),gt(B.$$.fragment,Q),gt(q.$$.fragment,Q),gt(U.$$.fragment,Q),gt(y.$$.fragment,Q),gt(at.$$.fragment,Q),gt(qt.$$.fragment,Q),ut=!1},d(Q){Q&&Z(t),_t(S),_t(N),_t(B),_t(q),_t(U),_t(y),_t(at),_t(qt),Ut=!1,Xt()}}}const qf=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function Gf(n,t,e){let i="",s="";function o(f){i=f,e(0,i)}function l(f){s=f,e(1,s)}return[i,s,o,l,async()=>{if(i&&s&&i.length<256&&qf.test(s)){try{const f=await Mf(Tf(zf,s),{name:i,email:s})}catch{alert("Error submitting your request. Have you already registered? If not, please try again later.");return}alert("Thank you for your interest! We will notify you as soon as access is available.")}else alert("Please fill in all the fields correctly.")}]}class Kf extends $e{constructor(t){super(),Ue(this,t,Gf,Hf,Fe,{})}}function Qf(n){let t,e,i,s,o,l,c,f,p,E,R;return s=new bl({}),l=new Kf({}),f=new wl({}),E=new Rl({}),{c(){t=L("img"),i=j(),ft(s.$$.fragment),o=j(),ft(l.$$.fragment),c=j(),ft(f.$$.fragment),p=j(),ft(E.$$.fragment),this.h()},l(w){t=F(w,"IMG",{src:!0,class:!0,alt:!0}),i=z(w),dt(s.$$.fragment,w),o=z(w),dt(l.$$.fragment,w),c=z(w),dt(f.$$.fragment,w),p=z(w),dt(E.$$.fragment,w),this.h()},h(){ai(t.src,e="/background_gradient.png")||k(t,"src",e),k(t,"class","absolute h-full w-full"),k(t,"alt","background gradient")},m(w,S){ie(w,t,S),ie(w,i,S),pt(s,w,S),ie(w,o,S),pt(l,w,S),ie(w,c,S),pt(f,w,S),ie(w,p,S),pt(E,w,S),R=!0},p:Ye,i(w){R||(mt(s.$$.fragment,w),mt(l.$$.fragment,w),mt(f.$$.fragment,w),mt(E.$$.fragment,w),R=!0)},o(w){gt(s.$$.fragment,w),gt(l.$$.fragment,w),gt(f.$$.fragment,w),gt(E.$$.fragment,w),R=!1},d(w){w&&(Z(t),Z(i),Z(o),Z(c),Z(p)),_t(s,w),_t(l,w),_t(f,w),_t(E,w)}}}class nd extends $e{constructor(t){super(),Ue(this,t,null,Qf,Fe,{})}}export{nd as component,Jf as universal};
